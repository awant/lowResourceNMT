INFO:tensorflow:Importing user module custom_problems from path /home/rimarakulin/lowResourceNMT/transfer_learning
[2018-03-26 00:57:12,263] Importing user module custom_problems from path /home/rimarakulin/lowResourceNMT/transfer_learning
INFO:tensorflow:schedule=continuous_train_and_eval
[2018-03-26 00:57:12,267] schedule=continuous_train_and_eval
INFO:tensorflow:worker_gpu=2
[2018-03-26 00:57:12,267] worker_gpu=2
INFO:tensorflow:sync=False
[2018-03-26 00:57:12,267] sync=False
WARNING:tensorflow:Schedule=continuous_train_and_eval. Assuming that training is running on a single machine.
[2018-03-26 00:57:12,268] Schedule=continuous_train_and_eval. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['gpu:0', 'gpu:1']
[2018-03-26 00:57:12,269] datashard_devices: ['gpu:0', 'gpu:1']
INFO:tensorflow:caching_devices: None
[2018-03-26 00:57:12,269] caching_devices: None
INFO:tensorflow:ps_devices: ['gpu:0', 'gpu:1']
[2018-03-26 00:57:12,270] ps_devices: ['gpu:0', 'gpu:1']
INFO:tensorflow:Using config: {'_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_keep_checkpoint_every_n_hours': 10000, '_keep_checkpoint_max': 20, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x7f05de5355c0>, 't2t_device_info': {'num_async_replicas': 1}, '_master': '', '_evaluation_master': '', '_log_step_count_steps': 100, '_task_type': None, 'use_tpu': False, '_num_ps_replicas': 0, '_save_summary_steps': 100, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f055464f080>, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_environment': 'local', '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
  }
}
, '_num_worker_replicas': 0, '_is_chief': True, '_tf_random_seed': 1234, '_model_dir': '/data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru', '_task_id': 0}
[2018-03-26 00:57:12,474] Using config: {'_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_keep_checkpoint_every_n_hours': 10000, '_keep_checkpoint_max': 20, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x7f05de5355c0>, 't2t_device_info': {'num_async_replicas': 1}, '_master': '', '_evaluation_master': '', '_log_step_count_steps': 100, '_task_type': None, 'use_tpu': False, '_num_ps_replicas': 0, '_save_summary_steps': 100, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f055464f080>, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_environment': 'local', '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
  }
}
, '_num_worker_replicas': 0, '_is_chief': True, '_tf_random_seed': 1234, '_model_dir': '/data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru', '_task_id': 0}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x7f05546c9510>) includes params argument, but params are not passed to Estimator.
[2018-03-26 00:57:12,474] Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x7f05546c9510>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:ValidationMonitor only works with --schedule=train_and_evaluate
[2018-03-26 00:57:12,475] ValidationMonitor only works with --schedule=train_and_evaluate
WARNING:tensorflow:Experiment.continuous_train_and_eval (from tensorflow.contrib.learn.python.learn.experiment) is experimental and may change or be removed at any time, and without warning.
[2018-03-26 00:57:12,476] Experiment.continuous_train_and_eval (from tensorflow.contrib.learn.python.learn.experiment) is experimental and may change or be removed at any time, and without warning.
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 00:57:12,485] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 00:57:12,499] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 00:57:12,501] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 00:57:12,665] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 00:57:16,125] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 00:57:16,127] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 00:57:16,173] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 00:57:16,423] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 00:57:16,431] Building model body
WARNING:tensorflow:From /home/rimarakulin/tensor2tensor/tensor2tensor/layers/common_layers.py:513: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
[2018-03-26 00:57:16,694] From /home/rimarakulin/tensor2tensor/tensor2tensor/layers/common_layers.py:513: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 00:57:22,986] Transforming body output with symbol_modality_33708_512.top
WARNING:tensorflow:From /home/rimarakulin/tensor2tensor/tensor2tensor/layers/common_layers.py:1717: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See tf.nn.softmax_cross_entropy_with_logits_v2.

[2018-03-26 00:57:23,050] From /home/rimarakulin/tensor2tensor/tensor2tensor/layers/common_layers.py:1717: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See tf.nn.softmax_cross_entropy_with_logits_v2.

INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 00:57:23,075] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 00:57:23,092] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 00:57:23,101] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 00:57:27,467] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 00:57:27,549] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 00:57:27,560] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 00:57:27,560] Using optimizer Adam
/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gradients_impl.py:98: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:Done calling model_fn.
[2018-03-26 00:57:40,780] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 00:57:40,781] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 00:57:48,354] Graph was finalized.
2018-03-26 00:57:54.564398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties: 
name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7715
pciBusID: 0000:04:00.0
totalMemory: 7.92GiB freeMemory: 7.80GiB
2018-03-26 00:57:54.988855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 1 with properties: 
name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.7715
pciBusID: 0000:05:00.0
totalMemory: 7.92GiB freeMemory: 7.80GiB
2018-03-26 00:57:54.990782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1227] Device peer to peer matrix
2018-03-26 00:57:54.990859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1233] DMA: 0 1 
2018-03-26 00:57:54.990877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 0:   Y Y 
2018-03-26 00:57:54.990888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1243] 1:   Y Y 
2018-03-26 00:57:54.990933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 00:57:55.624933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 00:57:55.711024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/averaged.ckpt-0
[2018-03-26 00:57:55,809] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/averaged.ckpt-0
INFO:tensorflow:Running local_init_op.
[2018-03-26 00:57:59,529] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 00:57:59,697] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 214538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 00:58:28,763] Saving checkpoints for 214538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 214538, loss = 9.650005
[2018-03-26 00:58:32,896] step = 214538, loss = 9.650005
INFO:tensorflow:global_step/sec: 2.08634
[2018-03-26 00:59:20,825] global_step/sec: 2.08634
INFO:tensorflow:step = 214638, loss = 6.997618 (47.931 sec)
[2018-03-26 00:59:20,827] step = 214638, loss = 6.997618 (47.931 sec)
INFO:tensorflow:global_step/sec: 2.47156
[2018-03-26 01:00:01,286] global_step/sec: 2.47156
INFO:tensorflow:step = 214738, loss = 6.9623656 (40.461 sec)
[2018-03-26 01:00:01,288] step = 214738, loss = 6.9623656 (40.461 sec)
INFO:tensorflow:global_step/sec: 2.46758
[2018-03-26 01:00:41,811] global_step/sec: 2.46758
INFO:tensorflow:step = 214838, loss = 6.963392 (40.525 sec)
[2018-03-26 01:00:41,813] step = 214838, loss = 6.963392 (40.525 sec)
INFO:tensorflow:global_step/sec: 2.45836
[2018-03-26 01:01:22,489] global_step/sec: 2.45836
INFO:tensorflow:step = 214938, loss = 6.555819 (40.678 sec)
[2018-03-26 01:01:22,491] step = 214938, loss = 6.555819 (40.678 sec)
INFO:tensorflow:global_step/sec: 2.46302
[2018-03-26 01:02:03,089] global_step/sec: 2.46302
INFO:tensorflow:step = 215038, loss = 6.6513596 (40.600 sec)
[2018-03-26 01:02:03,091] step = 215038, loss = 6.6513596 (40.600 sec)
INFO:tensorflow:global_step/sec: 2.45458
[2018-03-26 01:02:43,829] global_step/sec: 2.45458
INFO:tensorflow:step = 215138, loss = 6.555095 (40.740 sec)
[2018-03-26 01:02:43,832] step = 215138, loss = 6.555095 (40.740 sec)
INFO:tensorflow:global_step/sec: 2.44394
[2018-03-26 01:03:24,747] global_step/sec: 2.44394
INFO:tensorflow:step = 215238, loss = 6.3198543 (40.917 sec)
[2018-03-26 01:03:24,749] step = 215238, loss = 6.3198543 (40.917 sec)
INFO:tensorflow:global_step/sec: 2.485
[2018-03-26 01:04:04,988] global_step/sec: 2.485
INFO:tensorflow:step = 215338, loss = 6.3138385 (40.242 sec)
[2018-03-26 01:04:04,991] step = 215338, loss = 6.3138385 (40.242 sec)
INFO:tensorflow:global_step/sec: 2.45061
[2018-03-26 01:04:45,794] global_step/sec: 2.45061
INFO:tensorflow:step = 215438, loss = 6.5912576 (40.805 sec)
[2018-03-26 01:04:45,796] step = 215438, loss = 6.5912576 (40.805 sec)
INFO:tensorflow:Saving checkpoints for 215537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:05:25,766] Saving checkpoints for 215537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 6.3010755.
[2018-03-26 01:05:30,718] Loss for final step: 6.3010755.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:05:30,721] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:05:30,735] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:05:30,738] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:05:30,818] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:05:30,894] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:05:34,455] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:05:34,455] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:05:34,456] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:05:34,456] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:05:34,456] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:05:34,456] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:05:34,457] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:05:34,495] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:05:34,593] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:05:34,600] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:05:40,857] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:05:40,934] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:05:40,949] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:05:40,957] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:05:45,177] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:05:45,461] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:05:45
[2018-03-26 01:05:45,482] Starting evaluation at 2018-03-25-22:05:45
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:05:45,877] Graph was finalized.
2018-03-26 01:05:45.878174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:05:45.878564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:05:45.879083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-215537
[2018-03-26 01:05:45,879] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-215537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:05:47,340] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:05:47,447] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:05:54,621] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:05:58,813] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:06:03,021] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:06:07,279] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:06:11,510] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:06:15,653] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:06:19,853] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:06:22,603] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:06:25,264] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:06:27,928] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:06:28
[2018-03-26 01:06:28,195] Finished evaluation at 2018-03-25-22:06:28
INFO:tensorflow:Saving dict for global step 215537: global_step = 215537, loss = 6.1047106, metrics-translate_en_to_ru/approx_bleu_score = 0.05433881, metrics-translate_en_to_ru/neg_log_perplexity = -7.048711
[2018-03-26 01:06:28,196] Saving dict for global step 215537: global_step = 215537, loss = 6.1047106, metrics-translate_en_to_ru/approx_bleu_score = 0.05433881, metrics-translate_en_to_ru/neg_log_perplexity = -7.048711
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:06:31,016] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:06:31,032] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:06:31,034] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:06:31,201] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:06:34,429] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:06:34,430] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:06:34,473] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:06:35,281] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:06:35,289] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:06:40,948] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:06:41,019] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:06:41,033] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:06:41,041] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:06:44,885] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:06:44,961] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:06:44,971] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:06:44,971] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:06:58,494] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:06:58,495] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:06:59,483] Graph was finalized.
2018-03-26 01:06:59.483706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:06:59.484014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:06:59.484369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-215537
[2018-03-26 01:06:59,485] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-215537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:07:03,053] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:07:03,296] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 215538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:07:34,639] Saving checkpoints for 215538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 215538, loss = 6.2230964
[2018-03-26 01:07:39,543] step = 215538, loss = 6.2230964
INFO:tensorflow:global_step/sec: 2.0749
[2018-03-26 01:08:27,738] global_step/sec: 2.0749
INFO:tensorflow:step = 215638, loss = 6.364622 (48.197 sec)
[2018-03-26 01:08:27,740] step = 215638, loss = 6.364622 (48.197 sec)
INFO:tensorflow:global_step/sec: 2.48347
[2018-03-26 01:09:08,004] global_step/sec: 2.48347
INFO:tensorflow:step = 215738, loss = 6.2123523 (40.266 sec)
[2018-03-26 01:09:08,006] step = 215738, loss = 6.2123523 (40.266 sec)
INFO:tensorflow:global_step/sec: 2.43026
[2018-03-26 01:09:49,152] global_step/sec: 2.43026
INFO:tensorflow:step = 215838, loss = 6.3123846 (41.148 sec)
[2018-03-26 01:09:49,154] step = 215838, loss = 6.3123846 (41.148 sec)
INFO:tensorflow:global_step/sec: 2.45848
[2018-03-26 01:10:29,827] global_step/sec: 2.45848
INFO:tensorflow:step = 215938, loss = 6.0673246 (40.675 sec)
[2018-03-26 01:10:29,829] step = 215938, loss = 6.0673246 (40.675 sec)
INFO:tensorflow:global_step/sec: 2.46394
[2018-03-26 01:11:10,413] global_step/sec: 2.46394
INFO:tensorflow:step = 216038, loss = 6.0173917 (40.586 sec)
[2018-03-26 01:11:10,415] step = 216038, loss = 6.0173917 (40.586 sec)
INFO:tensorflow:global_step/sec: 2.47207
[2018-03-26 01:11:50,864] global_step/sec: 2.47207
INFO:tensorflow:step = 216138, loss = 5.763573 (40.452 sec)
[2018-03-26 01:11:50,867] step = 216138, loss = 5.763573 (40.452 sec)
INFO:tensorflow:global_step/sec: 2.45384
[2018-03-26 01:12:31,617] global_step/sec: 2.45384
INFO:tensorflow:step = 216238, loss = 5.590111 (40.753 sec)
[2018-03-26 01:12:31,619] step = 216238, loss = 5.590111 (40.753 sec)
INFO:tensorflow:global_step/sec: 2.46751
[2018-03-26 01:13:12,144] global_step/sec: 2.46751
INFO:tensorflow:step = 216338, loss = 5.485848 (40.527 sec)
[2018-03-26 01:13:12,146] step = 216338, loss = 5.485848 (40.527 sec)
INFO:tensorflow:global_step/sec: 2.46431
[2018-03-26 01:13:52,723] global_step/sec: 2.46431
INFO:tensorflow:step = 216438, loss = 5.9157057 (40.580 sec)
[2018-03-26 01:13:52,725] step = 216438, loss = 5.9157057 (40.580 sec)
INFO:tensorflow:Saving checkpoints for 216537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:14:32,830] Saving checkpoints for 216537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 5.7515473.
[2018-03-26 01:14:37,396] Loss for final step: 5.7515473.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:14:37,397] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:14:37,410] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:14:37,413] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:14:37,514] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:14:37,627] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:14:40,710] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:14:40,710] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:14:40,710] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:14:40,710] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:14:40,710] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:14:40,710] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:14:40,711] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:14:40,751] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:14:40,855] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:14:40,864] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:14:46,676] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:14:46,749] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:14:46,764] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:14:46,772] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:14:50,585] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:14:50,847] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:14:50
[2018-03-26 01:14:50,865] Starting evaluation at 2018-03-25-22:14:50
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:14:51,228] Graph was finalized.
2018-03-26 01:14:51.229195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:14:51.229527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:14:51.229897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-216537
[2018-03-26 01:14:51,230] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-216537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:14:52,573] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:14:52,739] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:14:59,717] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:15:03,888] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:15:08,010] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:15:12,109] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:15:16,274] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:15:20,633] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:15:24,920] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:15:27,655] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:15:30,309] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:15:33,012] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:15:33
[2018-03-26 01:15:33,374] Finished evaluation at 2018-03-25-22:15:33
INFO:tensorflow:Saving dict for global step 216537: global_step = 216537, loss = 5.610657, metrics-translate_en_to_ru/approx_bleu_score = 0.071272366, metrics-translate_en_to_ru/neg_log_perplexity = -6.467783
[2018-03-26 01:15:33,376] Saving dict for global step 216537: global_step = 216537, loss = 5.610657, metrics-translate_en_to_ru/approx_bleu_score = 0.071272366, metrics-translate_en_to_ru/neg_log_perplexity = -6.467783
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:15:33,378] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:15:33,410] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:15:33,413] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:15:33,569] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:15:36,856] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:15:36,857] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:15:36,898] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:15:37,001] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:15:37,008] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:15:42,911] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:15:42,979] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:15:42,994] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:15:43,001] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:15:46,624] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:15:46,700] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:15:46,710] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:15:46,710] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:16:00,022] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:16:00,023] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:16:00,868] Graph was finalized.
2018-03-26 01:16:00.868604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:16:00.868944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:16:00.869655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-216537
[2018-03-26 01:16:00,871] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-216537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:16:04,256] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:16:04,555] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 216538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:16:32,757] Saving checkpoints for 216538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 216538, loss = 5.636922
[2018-03-26 01:16:37,773] step = 216538, loss = 5.636922
INFO:tensorflow:global_step/sec: 2.01557
[2018-03-26 01:17:27,384] global_step/sec: 2.01557
INFO:tensorflow:step = 216638, loss = 5.7881827 (49.613 sec)
[2018-03-26 01:17:27,386] step = 216638, loss = 5.7881827 (49.613 sec)
INFO:tensorflow:global_step/sec: 2.45667
[2018-03-26 01:18:08,090] global_step/sec: 2.45667
INFO:tensorflow:step = 216738, loss = 5.536281 (40.706 sec)
[2018-03-26 01:18:08,092] step = 216738, loss = 5.536281 (40.706 sec)
INFO:tensorflow:global_step/sec: 2.46271
[2018-03-26 01:18:48,695] global_step/sec: 2.46271
INFO:tensorflow:step = 216838, loss = 5.622574 (40.606 sec)
[2018-03-26 01:18:48,698] step = 216838, loss = 5.622574 (40.606 sec)
INFO:tensorflow:global_step/sec: 2.46405
[2018-03-26 01:19:29,279] global_step/sec: 2.46405
INFO:tensorflow:step = 216938, loss = 5.503346 (40.583 sec)
[2018-03-26 01:19:29,281] step = 216938, loss = 5.503346 (40.583 sec)
INFO:tensorflow:global_step/sec: 2.45317
[2018-03-26 01:20:10,042] global_step/sec: 2.45317
INFO:tensorflow:step = 217038, loss = 5.687167 (40.764 sec)
[2018-03-26 01:20:10,045] step = 217038, loss = 5.687167 (40.764 sec)
INFO:tensorflow:global_step/sec: 2.45587
[2018-03-26 01:20:50,761] global_step/sec: 2.45587
INFO:tensorflow:step = 217138, loss = 5.9393277 (40.718 sec)
[2018-03-26 01:20:50,763] step = 217138, loss = 5.9393277 (40.718 sec)
INFO:tensorflow:global_step/sec: 2.45806
[2018-03-26 01:21:31,444] global_step/sec: 2.45806
INFO:tensorflow:step = 217238, loss = 5.5041523 (40.682 sec)
[2018-03-26 01:21:31,445] step = 217238, loss = 5.5041523 (40.682 sec)
INFO:tensorflow:global_step/sec: 2.46942
[2018-03-26 01:22:11,939] global_step/sec: 2.46942
INFO:tensorflow:step = 217338, loss = 5.4657416 (40.496 sec)
[2018-03-26 01:22:11,941] step = 217338, loss = 5.4657416 (40.496 sec)
INFO:tensorflow:global_step/sec: 2.4384
[2018-03-26 01:22:52,949] global_step/sec: 2.4384
INFO:tensorflow:step = 217438, loss = 5.6464295 (41.010 sec)
[2018-03-26 01:22:52,951] step = 217438, loss = 5.6464295 (41.010 sec)
INFO:tensorflow:Saving checkpoints for 217537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:23:32,873] Saving checkpoints for 217537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 5.2296.
[2018-03-26 01:23:37,027] Loss for final step: 5.2296.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:23:37,029] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:23:37,036] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:23:37,038] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:23:37,091] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:23:37,147] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:23:40,044] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:23:40,044] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:23:40,044] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:23:40,044] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:23:40,045] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:23:40,045] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:23:40,045] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:23:40,092] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:23:40,182] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:23:40,190] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:23:46,276] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:23:46,350] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:23:46,365] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:23:46,373] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:23:50,346] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:23:50,624] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:23:50
[2018-03-26 01:23:50,641] Starting evaluation at 2018-03-25-22:23:50
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:23:50,991] Graph was finalized.
2018-03-26 01:23:50.991963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:23:50.992196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:23:50.992471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-217537
[2018-03-26 01:23:50,992] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-217537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:23:52,374] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:23:52,517] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:23:59,965] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:24:04,035] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:24:08,160] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:24:12,308] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:24:16,444] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:24:20,618] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:24:24,898] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:24:27,690] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:24:30,369] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:24:32,980] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:24:33
[2018-03-26 01:24:33,299] Finished evaluation at 2018-03-25-22:24:33
INFO:tensorflow:Saving dict for global step 217537: global_step = 217537, loss = 5.315378, metrics-translate_en_to_ru/approx_bleu_score = 0.082107894, metrics-translate_en_to_ru/neg_log_perplexity = -6.1185446
[2018-03-26 01:24:33,301] Saving dict for global step 217537: global_step = 217537, loss = 5.315378, metrics-translate_en_to_ru/approx_bleu_score = 0.082107894, metrics-translate_en_to_ru/neg_log_perplexity = -6.1185446
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:24:33,304] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:24:33,322] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:24:33,324] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:24:33,469] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:24:36,814] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:24:36,815] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:24:36,856] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:24:36,952] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:24:36,960] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:24:43,403] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:24:43,483] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:24:43,499] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:24:43,507] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:24:47,648] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:24:47,741] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:24:47,753] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:24:47,754] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:25:01,562] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:25:01,563] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:25:02,527] Graph was finalized.
2018-03-26 01:25:02.527413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:25:02.527688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:25:02.528017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-217537
[2018-03-26 01:25:02,528] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-217537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:25:06,498] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:25:06,734] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 217538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:25:37,805] Saving checkpoints for 217538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 217538, loss = 5.4521513
[2018-03-26 01:25:42,161] step = 217538, loss = 5.4521513
INFO:tensorflow:global_step/sec: 2.10175
[2018-03-26 01:26:29,740] global_step/sec: 2.10175
INFO:tensorflow:step = 217638, loss = 5.5718346 (47.581 sec)
[2018-03-26 01:26:29,742] step = 217638, loss = 5.5718346 (47.581 sec)
INFO:tensorflow:global_step/sec: 2.48127
[2018-03-26 01:27:10,042] global_step/sec: 2.48127
INFO:tensorflow:step = 217738, loss = 5.507689 (40.301 sec)
[2018-03-26 01:27:10,043] step = 217738, loss = 5.507689 (40.301 sec)
INFO:tensorflow:global_step/sec: 2.44015
[2018-03-26 01:27:51,023] global_step/sec: 2.44015
INFO:tensorflow:step = 217838, loss = 5.3608675 (40.982 sec)
[2018-03-26 01:27:51,025] step = 217838, loss = 5.3608675 (40.982 sec)
INFO:tensorflow:global_step/sec: 2.46136
[2018-03-26 01:28:31,651] global_step/sec: 2.46136
INFO:tensorflow:step = 217938, loss = 5.7268386 (40.628 sec)
[2018-03-26 01:28:31,654] step = 217938, loss = 5.7268386 (40.628 sec)
INFO:tensorflow:global_step/sec: 2.45467
[2018-03-26 01:29:12,390] global_step/sec: 2.45467
INFO:tensorflow:step = 218038, loss = 5.624255 (40.739 sec)
[2018-03-26 01:29:12,392] step = 218038, loss = 5.624255 (40.739 sec)
INFO:tensorflow:global_step/sec: 2.47186
[2018-03-26 01:29:52,845] global_step/sec: 2.47186
INFO:tensorflow:step = 218138, loss = 5.3828597 (40.455 sec)
[2018-03-26 01:29:52,848] step = 218138, loss = 5.3828597 (40.455 sec)
INFO:tensorflow:global_step/sec: 2.46148
[2018-03-26 01:30:33,471] global_step/sec: 2.46148
INFO:tensorflow:step = 218238, loss = 5.370915 (40.625 sec)
[2018-03-26 01:30:33,473] step = 218238, loss = 5.370915 (40.625 sec)
INFO:tensorflow:global_step/sec: 2.4658
[2018-03-26 01:31:14,026] global_step/sec: 2.4658
INFO:tensorflow:step = 218338, loss = 5.668821 (40.555 sec)
[2018-03-26 01:31:14,028] step = 218338, loss = 5.668821 (40.555 sec)
INFO:tensorflow:global_step/sec: 2.46635
[2018-03-26 01:31:54,572] global_step/sec: 2.46635
INFO:tensorflow:step = 218438, loss = 5.4585223 (40.545 sec)
[2018-03-26 01:31:54,574] step = 218438, loss = 5.4585223 (40.545 sec)
INFO:tensorflow:Saving checkpoints for 218537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:32:34,707] Saving checkpoints for 218537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 5.17517.
[2018-03-26 01:32:39,196] Loss for final step: 5.17517.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:32:39,197] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:32:39,206] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:32:39,208] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:32:39,300] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:32:39,365] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:32:42,279] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:32:42,279] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:32:42,279] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:32:42,279] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:32:42,279] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:32:42,279] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:32:42,280] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:32:42,317] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:32:42,420] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:32:42,430] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:32:48,776] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:32:48,848] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:32:48,863] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:32:48,871] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:32:52,355] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:32:52,907] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:32:52
[2018-03-26 01:32:52,926] Starting evaluation at 2018-03-25-22:32:52
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:32:53,286] Graph was finalized.
2018-03-26 01:32:53.286469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:32:53.286723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:32:53.287020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-218537
[2018-03-26 01:32:53,287] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-218537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:32:54,658] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:32:54,760] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:33:01,627] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:33:05,707] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:33:09,812] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:33:14,050] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:33:18,269] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:33:22,373] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:33:26,599] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:33:29,357] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:33:32,085] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:33:34,850] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:33:35
[2018-03-26 01:33:35,194] Finished evaluation at 2018-03-25-22:33:35
INFO:tensorflow:Saving dict for global step 218537: global_step = 218537, loss = 5.0975904, metrics-translate_en_to_ru/approx_bleu_score = 0.092286915, metrics-translate_en_to_ru/neg_log_perplexity = -5.8605976
[2018-03-26 01:33:35,198] Saving dict for global step 218537: global_step = 218537, loss = 5.0975904, metrics-translate_en_to_ru/approx_bleu_score = 0.092286915, metrics-translate_en_to_ru/neg_log_perplexity = -5.8605976
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:33:35,202] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:33:35,238] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:33:35,241] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:33:35,400] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:33:38,495] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:33:38,496] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:33:38,536] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:33:38,639] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:33:38,647] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:33:44,611] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:33:44,684] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:33:44,699] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:33:44,709] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:33:48,834] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:33:48,914] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:33:48,925] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:33:48,925] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:34:03,513] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:34:03,515] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:34:04,619] Graph was finalized.
2018-03-26 01:34:04.619401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:34:05.308191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:34:05.315507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-218537
[2018-03-26 01:34:05,317] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-218537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:34:08,991] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:34:09,223] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 218538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:34:35,238] Saving checkpoints for 218538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 218538, loss = 5.2572055
[2018-03-26 01:34:39,249] step = 218538, loss = 5.2572055
INFO:tensorflow:global_step/sec: 2.10988
[2018-03-26 01:35:26,644] global_step/sec: 2.10988
INFO:tensorflow:step = 218638, loss = 5.1733346 (47.398 sec)
[2018-03-26 01:35:26,646] step = 218638, loss = 5.1733346 (47.398 sec)
INFO:tensorflow:global_step/sec: 2.4582
[2018-03-26 01:36:07,324] global_step/sec: 2.4582
INFO:tensorflow:step = 218738, loss = 5.3220854 (40.680 sec)
[2018-03-26 01:36:07,326] step = 218738, loss = 5.3220854 (40.680 sec)
INFO:tensorflow:global_step/sec: 2.47348
[2018-03-26 01:36:47,753] global_step/sec: 2.47348
INFO:tensorflow:step = 218838, loss = 5.100679 (40.429 sec)
[2018-03-26 01:36:47,756] step = 218838, loss = 5.100679 (40.429 sec)
INFO:tensorflow:global_step/sec: 2.46021
[2018-03-26 01:37:28,400] global_step/sec: 2.46021
INFO:tensorflow:step = 218938, loss = 5.5630393 (40.647 sec)
[2018-03-26 01:37:28,402] step = 218938, loss = 5.5630393 (40.647 sec)
INFO:tensorflow:global_step/sec: 2.46039
[2018-03-26 01:38:09,044] global_step/sec: 2.46039
INFO:tensorflow:step = 219038, loss = 5.0682535 (40.644 sec)
[2018-03-26 01:38:09,046] step = 219038, loss = 5.0682535 (40.644 sec)
INFO:tensorflow:global_step/sec: 2.4712
[2018-03-26 01:38:49,510] global_step/sec: 2.4712
INFO:tensorflow:step = 219138, loss = 5.3051085 (40.466 sec)
[2018-03-26 01:38:49,512] step = 219138, loss = 5.3051085 (40.466 sec)
INFO:tensorflow:global_step/sec: 2.45734
[2018-03-26 01:39:30,205] global_step/sec: 2.45734
INFO:tensorflow:step = 219238, loss = 5.36908 (40.694 sec)
[2018-03-26 01:39:30,207] step = 219238, loss = 5.36908 (40.694 sec)
INFO:tensorflow:global_step/sec: 2.44198
[2018-03-26 01:40:11,155] global_step/sec: 2.44198
INFO:tensorflow:step = 219338, loss = 5.110836 (40.950 sec)
[2018-03-26 01:40:11,157] step = 219338, loss = 5.110836 (40.950 sec)
INFO:tensorflow:global_step/sec: 2.47613
[2018-03-26 01:40:51,541] global_step/sec: 2.47613
INFO:tensorflow:step = 219438, loss = 5.4194264 (40.386 sec)
[2018-03-26 01:40:51,543] step = 219438, loss = 5.4194264 (40.386 sec)
INFO:tensorflow:Saving checkpoints for 219537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:41:32,084] Saving checkpoints for 219537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.7987285.
[2018-03-26 01:41:36,247] Loss for final step: 4.7987285.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:41:36,248] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:41:36,257] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:41:36,267] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:41:36,336] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:41:36,413] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:41:39,386] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:41:39,386] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:41:39,386] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:41:39,386] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:41:39,386] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:41:39,386] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:41:39,387] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:41:39,424] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:41:39,518] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:41:39,526] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:41:45,456] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:41:45,523] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:41:45,537] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:41:45,545] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:41:49,195] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:41:49,476] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:41:49
[2018-03-26 01:41:49,496] Starting evaluation at 2018-03-25-22:41:49
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:41:49,868] Graph was finalized.
2018-03-26 01:41:49.868984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:41:49.869166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:41:49.869432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-219537
[2018-03-26 01:41:49,869] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-219537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:41:51,285] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:41:51,409] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:41:58,566] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:42:02,761] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:42:06,899] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:42:11,166] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:42:15,302] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:42:19,452] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:42:23,667] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:42:26,399] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:42:29,050] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:42:31,665] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:42:31
[2018-03-26 01:42:31,963] Finished evaluation at 2018-03-25-22:42:31
INFO:tensorflow:Saving dict for global step 219537: global_step = 219537, loss = 4.9216204, metrics-translate_en_to_ru/approx_bleu_score = 0.101761535, metrics-translate_en_to_ru/neg_log_perplexity = -5.6480494
[2018-03-26 01:42:31,964] Saving dict for global step 219537: global_step = 219537, loss = 4.9216204, metrics-translate_en_to_ru/approx_bleu_score = 0.101761535, metrics-translate_en_to_ru/neg_log_perplexity = -5.6480494
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:42:31,967] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:42:31,986] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:42:31,988] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:42:32,158] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:42:35,412] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:42:35,413] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:42:35,452] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:42:35,552] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:42:35,560] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:42:42,021] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:42:42,109] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:42:42,126] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:42:42,135] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:42:46,632] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:42:46,724] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:42:46,739] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:42:46,739] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:43:01,422] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:43:01,424] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:43:02,426] Graph was finalized.
2018-03-26 01:43:02.426719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:43:02.426988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:43:02.427317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-219537
[2018-03-26 01:43:02,428] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-219537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:43:05,917] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:43:06,153] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 219538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:43:34,348] Saving checkpoints for 219538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 219538, loss = 5.127027
[2018-03-26 01:43:38,507] step = 219538, loss = 5.127027
INFO:tensorflow:global_step/sec: 2.08802
[2018-03-26 01:44:26,399] global_step/sec: 2.08802
INFO:tensorflow:step = 219638, loss = 4.8436637 (47.894 sec)
[2018-03-26 01:44:26,401] step = 219638, loss = 4.8436637 (47.894 sec)
INFO:tensorflow:global_step/sec: 2.48976
[2018-03-26 01:45:06,563] global_step/sec: 2.48976
INFO:tensorflow:step = 219738, loss = 5.2039895 (40.163 sec)
[2018-03-26 01:45:06,565] step = 219738, loss = 5.2039895 (40.163 sec)
INFO:tensorflow:global_step/sec: 2.45037
[2018-03-26 01:45:47,373] global_step/sec: 2.45037
INFO:tensorflow:step = 219838, loss = 4.6203313 (40.811 sec)
[2018-03-26 01:45:47,376] step = 219838, loss = 4.6203313 (40.811 sec)
INFO:tensorflow:global_step/sec: 2.44761
[2018-03-26 01:46:28,229] global_step/sec: 2.44761
INFO:tensorflow:step = 219938, loss = 5.391944 (40.856 sec)
[2018-03-26 01:46:28,231] step = 219938, loss = 5.391944 (40.856 sec)
INFO:tensorflow:global_step/sec: 2.44754
[2018-03-26 01:47:09,087] global_step/sec: 2.44754
INFO:tensorflow:step = 220038, loss = 4.9960084 (40.858 sec)
[2018-03-26 01:47:09,089] step = 220038, loss = 4.9960084 (40.858 sec)
INFO:tensorflow:global_step/sec: 2.46018
[2018-03-26 01:47:49,734] global_step/sec: 2.46018
INFO:tensorflow:step = 220138, loss = 5.511544 (40.647 sec)
[2018-03-26 01:47:49,736] step = 220138, loss = 5.511544 (40.647 sec)
INFO:tensorflow:global_step/sec: 2.46136
[2018-03-26 01:48:30,362] global_step/sec: 2.46136
INFO:tensorflow:step = 220238, loss = 5.184802 (40.628 sec)
[2018-03-26 01:48:30,365] step = 220238, loss = 5.184802 (40.628 sec)
INFO:tensorflow:global_step/sec: 2.47027
[2018-03-26 01:49:10,843] global_step/sec: 2.47027
INFO:tensorflow:step = 220338, loss = 5.294152 (40.481 sec)
[2018-03-26 01:49:10,845] step = 220338, loss = 5.294152 (40.481 sec)
INFO:tensorflow:global_step/sec: 2.46248
[2018-03-26 01:49:51,453] global_step/sec: 2.46248
INFO:tensorflow:step = 220438, loss = 5.1596427 (40.610 sec)
[2018-03-26 01:49:51,455] step = 220438, loss = 5.1596427 (40.610 sec)
INFO:tensorflow:Saving checkpoints for 220537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:50:31,543] Saving checkpoints for 220537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.964315.
[2018-03-26 01:50:35,928] Loss for final step: 4.964315.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:50:35,930] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:50:35,940] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:50:35,947] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:50:36,047] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:50:36,116] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:50:39,041] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:50:39,041] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:50:39,041] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:50:39,042] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:50:39,042] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:50:39,042] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:50:39,042] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:50:39,079] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:50:40,329] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:50:40,337] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:50:45,515] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:50:45,588] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:50:45,603] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:50:45,611] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:50:49,347] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:50:49,613] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:50:49
[2018-03-26 01:50:49,631] Starting evaluation at 2018-03-25-22:50:49
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:50:49,993] Graph was finalized.
2018-03-26 01:50:49.993337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:50:49.993602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:50:49.993884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-220537
[2018-03-26 01:50:49,994] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-220537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:50:51,189] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:50:51,281] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:50:58,094] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:51:02,243] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 01:51:06,390] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 01:51:10,565] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 01:51:14,758] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 01:51:18,916] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 01:51:23,163] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 01:51:25,900] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 01:51:28,558] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 01:51:31,186] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-22:51:31
[2018-03-26 01:51:31,487] Finished evaluation at 2018-03-25-22:51:31
INFO:tensorflow:Saving dict for global step 220537: global_step = 220537, loss = 4.755917, metrics-translate_en_to_ru/approx_bleu_score = 0.110977314, metrics-translate_en_to_ru/neg_log_perplexity = -5.4573073
[2018-03-26 01:51:31,491] Saving dict for global step 220537: global_step = 220537, loss = 4.755917, metrics-translate_en_to_ru/approx_bleu_score = 0.110977314, metrics-translate_en_to_ru/neg_log_perplexity = -5.4573073
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 01:51:31,495] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 01:51:31,520] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 01:51:31,523] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:51:31,698] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 01:51:34,783] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:51:34,784] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:51:34,825] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:51:34,929] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:51:34,938] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:51:41,188] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:51:41,261] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:51:41,276] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:51:41,284] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:51:45,383] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 01:51:45,464] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 01:51:45,475] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 01:51:45,475] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:51:58,609] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 01:51:58,610] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:52:00,007] Graph was finalized.
2018-03-26 01:52:00.007474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:52:00.007714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:52:00.008021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-220537
[2018-03-26 01:52:00,009] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-220537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:52:03,055] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:52:03,269] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 220538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:52:31,731] Saving checkpoints for 220538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 220538, loss = 4.881256
[2018-03-26 01:52:36,029] step = 220538, loss = 4.881256
INFO:tensorflow:global_step/sec: 2.05509
[2018-03-26 01:53:24,688] global_step/sec: 2.05509
INFO:tensorflow:step = 220638, loss = 4.362661 (48.661 sec)
[2018-03-26 01:53:24,690] step = 220638, loss = 4.362661 (48.661 sec)
INFO:tensorflow:global_step/sec: 2.46198
[2018-03-26 01:54:05,305] global_step/sec: 2.46198
INFO:tensorflow:step = 220738, loss = 4.928529 (40.618 sec)
[2018-03-26 01:54:05,308] step = 220738, loss = 4.928529 (40.618 sec)
INFO:tensorflow:global_step/sec: 2.47553
[2018-03-26 01:54:45,701] global_step/sec: 2.47553
INFO:tensorflow:step = 220838, loss = 4.929496 (40.395 sec)
[2018-03-26 01:54:45,703] step = 220838, loss = 4.929496 (40.395 sec)
INFO:tensorflow:global_step/sec: 2.46155
[2018-03-26 01:55:26,326] global_step/sec: 2.46155
INFO:tensorflow:step = 220938, loss = 4.9237475 (40.624 sec)
[2018-03-26 01:55:26,328] step = 220938, loss = 4.9237475 (40.624 sec)
INFO:tensorflow:global_step/sec: 2.45637
[2018-03-26 01:56:07,036] global_step/sec: 2.45637
INFO:tensorflow:step = 221038, loss = 4.8666716 (40.711 sec)
[2018-03-26 01:56:07,038] step = 221038, loss = 4.8666716 (40.711 sec)
INFO:tensorflow:global_step/sec: 2.46341
[2018-03-26 01:56:47,630] global_step/sec: 2.46341
INFO:tensorflow:step = 221138, loss = 4.776134 (40.594 sec)
[2018-03-26 01:56:47,632] step = 221138, loss = 4.776134 (40.594 sec)
INFO:tensorflow:global_step/sec: 2.4559
[2018-03-26 01:57:28,348] global_step/sec: 2.4559
INFO:tensorflow:step = 221238, loss = 4.7567267 (40.718 sec)
[2018-03-26 01:57:28,351] step = 221238, loss = 4.7567267 (40.718 sec)
INFO:tensorflow:global_step/sec: 2.44879
[2018-03-26 01:58:09,185] global_step/sec: 2.44879
INFO:tensorflow:step = 221338, loss = 4.83803 (40.837 sec)
[2018-03-26 01:58:09,187] step = 221338, loss = 4.83803 (40.837 sec)
INFO:tensorflow:global_step/sec: 2.48426
[2018-03-26 01:58:49,438] global_step/sec: 2.48426
INFO:tensorflow:step = 221438, loss = 4.9376807 (40.254 sec)
[2018-03-26 01:58:49,441] step = 221438, loss = 4.9376807 (40.254 sec)
INFO:tensorflow:Saving checkpoints for 221537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 01:59:30,089] Saving checkpoints for 221537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.9730816.
[2018-03-26 01:59:34,195] Loss for final step: 4.9730816.
INFO:tensorflow:Evaluating model now.
[2018-03-26 01:59:34,196] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 01:59:34,205] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 01:59:34,208] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 01:59:34,276] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 01:59:34,360] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 01:59:37,396] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 01:59:37,396] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 01:59:37,396] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 01:59:37,396] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 01:59:37,396] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 01:59:37,396] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 01:59:37,397] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:59:37,434] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:59:37,529] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:59:37,537] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:59:43,178] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 01:59:43,245] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 01:59:43,259] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 01:59:43,267] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 01:59:46,860] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 01:59:47,101] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-22:59:47
[2018-03-26 01:59:47,118] Starting evaluation at 2018-03-25-22:59:47
INFO:tensorflow:Graph was finalized.
[2018-03-26 01:59:47,475] Graph was finalized.
2018-03-26 01:59:47.475660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 01:59:47.475853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 01:59:47.476132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-221537
[2018-03-26 01:59:47,476] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-221537
INFO:tensorflow:Running local_init_op.
[2018-03-26 01:59:48,758] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 01:59:48,881] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 01:59:55,689] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 01:59:59,836] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:00:03,951] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:00:08,118] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:00:12,265] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:00:16,437] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:00:20,558] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:00:23,331] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:00:25,989] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:00:28,656] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:00:28
[2018-03-26 02:00:28,991] Finished evaluation at 2018-03-25-23:00:28
INFO:tensorflow:Saving dict for global step 221537: global_step = 221537, loss = 4.631565, metrics-translate_en_to_ru/approx_bleu_score = 0.11878204, metrics-translate_en_to_ru/neg_log_perplexity = -5.305833
[2018-03-26 02:00:28,993] Saving dict for global step 221537: global_step = 221537, loss = 4.631565, metrics-translate_en_to_ru/approx_bleu_score = 0.11878204, metrics-translate_en_to_ru/neg_log_perplexity = -5.305833
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:00:28,995] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:00:29,013] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:00:29,016] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:00:29,180] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:00:32,584] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:00:32,585] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:00:32,632] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:00:32,762] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:00:32,772] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:00:39,729] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:00:39,816] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:00:39,834] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:00:39,843] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:00:44,295] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:00:44,377] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:00:44,389] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:00:44,389] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:00:58,406] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:00:58,407] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:00:59,308] Graph was finalized.
2018-03-26 02:00:59.308641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:00:59.308931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:00:59.309260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-221537
[2018-03-26 02:00:59,310] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-221537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:01:02,343] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:01:02,569] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 221538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:01:32,729] Saving checkpoints for 221538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 221538, loss = 4.686237
[2018-03-26 02:01:36,988] step = 221538, loss = 4.686237
INFO:tensorflow:global_step/sec: 2.09094
[2018-03-26 02:02:24,813] global_step/sec: 2.09094
INFO:tensorflow:step = 221638, loss = 4.3114896 (47.827 sec)
[2018-03-26 02:02:24,815] step = 221638, loss = 4.3114896 (47.827 sec)
INFO:tensorflow:global_step/sec: 2.46731
[2018-03-26 02:03:05,342] global_step/sec: 2.46731
INFO:tensorflow:step = 221738, loss = 4.3066278 (40.529 sec)
[2018-03-26 02:03:05,344] step = 221738, loss = 4.3066278 (40.529 sec)
INFO:tensorflow:global_step/sec: 2.4469
[2018-03-26 02:03:46,211] global_step/sec: 2.4469
INFO:tensorflow:step = 221838, loss = 5.3169904 (40.869 sec)
[2018-03-26 02:03:46,213] step = 221838, loss = 5.3169904 (40.869 sec)
INFO:tensorflow:global_step/sec: 2.48007
[2018-03-26 02:04:26,532] global_step/sec: 2.48007
INFO:tensorflow:step = 221938, loss = 4.5689187 (40.320 sec)
[2018-03-26 02:04:26,533] step = 221938, loss = 4.5689187 (40.320 sec)
INFO:tensorflow:global_step/sec: 2.45862
[2018-03-26 02:05:07,205] global_step/sec: 2.45862
INFO:tensorflow:step = 222038, loss = 4.824494 (40.674 sec)
[2018-03-26 02:05:07,208] step = 222038, loss = 4.824494 (40.674 sec)
INFO:tensorflow:global_step/sec: 2.49073
[2018-03-26 02:05:47,354] global_step/sec: 2.49073
INFO:tensorflow:step = 222138, loss = 4.6141834 (40.149 sec)
[2018-03-26 02:05:47,357] step = 222138, loss = 4.6141834 (40.149 sec)
INFO:tensorflow:global_step/sec: 2.48155
[2018-03-26 02:06:27,652] global_step/sec: 2.48155
INFO:tensorflow:step = 222238, loss = 4.632778 (40.297 sec)
[2018-03-26 02:06:27,653] step = 222238, loss = 4.632778 (40.297 sec)
INFO:tensorflow:global_step/sec: 2.47596
[2018-03-26 02:07:08,040] global_step/sec: 2.47596
INFO:tensorflow:step = 222338, loss = 4.8727255 (40.389 sec)
[2018-03-26 02:07:08,042] step = 222338, loss = 4.8727255 (40.389 sec)
INFO:tensorflow:global_step/sec: 2.46784
[2018-03-26 02:07:48,561] global_step/sec: 2.46784
INFO:tensorflow:step = 222438, loss = 4.880021 (40.522 sec)
[2018-03-26 02:07:48,564] step = 222438, loss = 4.880021 (40.522 sec)
INFO:tensorflow:Saving checkpoints for 222537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:08:28,556] Saving checkpoints for 222537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.0460024.
[2018-03-26 02:08:33,097] Loss for final step: 4.0460024.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:08:33,098] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:08:33,107] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:08:33,109] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:08:33,177] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:08:33,254] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:08:36,642] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:08:36,642] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:08:36,642] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:08:36,642] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:08:36,642] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:08:36,643] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:08:36,643] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:08:36,685] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:08:36,792] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:08:36,801] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:08:43,683] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:08:43,765] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:08:43,783] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:08:43,792] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:08:47,615] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:08:48,152] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:08:48
[2018-03-26 02:08:48,171] Starting evaluation at 2018-03-25-23:08:48
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:08:48,536] Graph was finalized.
2018-03-26 02:08:48.536284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:08:48.536578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:08:48.536899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-222537
[2018-03-26 02:08:48,537] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-222537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:08:49,875] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:08:49,990] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:08:57,064] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:09:01,178] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:09:05,536] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:09:09,760] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:09:13,874] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:09:18,073] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:09:22,191] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:09:24,900] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:09:27,554] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:09:30,215] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:09:30
[2018-03-26 02:09:30,519] Finished evaluation at 2018-03-25-23:09:30
INFO:tensorflow:Saving dict for global step 222537: global_step = 222537, loss = 4.515198, metrics-translate_en_to_ru/approx_bleu_score = 0.1262169, metrics-translate_en_to_ru/neg_log_perplexity = -5.169728
[2018-03-26 02:09:30,520] Saving dict for global step 222537: global_step = 222537, loss = 4.515198, metrics-translate_en_to_ru/approx_bleu_score = 0.1262169, metrics-translate_en_to_ru/neg_log_perplexity = -5.169728
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:09:30,526] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:09:30,542] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:09:30,545] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:09:30,655] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:09:33,970] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:09:33,971] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:09:34,013] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:09:34,164] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:09:34,174] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:09:40,997] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:09:41,119] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:09:41,139] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:09:41,149] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:09:45,570] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:09:45,662] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:09:45,674] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:09:45,675] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:09:59,597] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:09:59,598] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:10:00,568] Graph was finalized.
2018-03-26 02:10:00.568981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:10:00.569338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:10:00.569732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-222537
[2018-03-26 02:10:00,571] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-222537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:10:04,045] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:10:04,346] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 222538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:10:33,417] Saving checkpoints for 222538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 222538, loss = 4.484205
[2018-03-26 02:10:37,568] step = 222538, loss = 4.484205
INFO:tensorflow:global_step/sec: 2.08159
[2018-03-26 02:11:25,607] global_step/sec: 2.08159
INFO:tensorflow:step = 222638, loss = 4.763573 (48.041 sec)
[2018-03-26 02:11:25,609] step = 222638, loss = 4.763573 (48.041 sec)
INFO:tensorflow:global_step/sec: 2.48268
[2018-03-26 02:12:05,886] global_step/sec: 2.48268
INFO:tensorflow:step = 222738, loss = 4.504704 (40.278 sec)
[2018-03-26 02:12:05,887] step = 222738, loss = 4.504704 (40.278 sec)
INFO:tensorflow:global_step/sec: 2.48237
[2018-03-26 02:12:46,170] global_step/sec: 2.48237
INFO:tensorflow:step = 222838, loss = 4.424626 (40.284 sec)
[2018-03-26 02:12:46,172] step = 222838, loss = 4.424626 (40.284 sec)
INFO:tensorflow:global_step/sec: 2.47381
[2018-03-26 02:13:26,593] global_step/sec: 2.47381
INFO:tensorflow:step = 222938, loss = 4.6614537 (40.424 sec)
[2018-03-26 02:13:26,595] step = 222938, loss = 4.6614537 (40.424 sec)
INFO:tensorflow:global_step/sec: 2.48602
[2018-03-26 02:14:06,819] global_step/sec: 2.48602
INFO:tensorflow:step = 223038, loss = 4.0524664 (40.226 sec)
[2018-03-26 02:14:06,821] step = 223038, loss = 4.0524664 (40.226 sec)
INFO:tensorflow:global_step/sec: 2.47554
[2018-03-26 02:14:47,214] global_step/sec: 2.47554
INFO:tensorflow:step = 223138, loss = 4.5633564 (40.395 sec)
[2018-03-26 02:14:47,216] step = 223138, loss = 4.5633564 (40.395 sec)
INFO:tensorflow:global_step/sec: 2.43839
[2018-03-26 02:15:28,225] global_step/sec: 2.43839
INFO:tensorflow:step = 223238, loss = 4.6690593 (41.011 sec)
[2018-03-26 02:15:28,227] step = 223238, loss = 4.6690593 (41.011 sec)
INFO:tensorflow:global_step/sec: 2.48122
[2018-03-26 02:16:08,527] global_step/sec: 2.48122
INFO:tensorflow:step = 223338, loss = 4.469264 (40.302 sec)
[2018-03-26 02:16:08,528] step = 223338, loss = 4.469264 (40.302 sec)
INFO:tensorflow:global_step/sec: 2.47466
[2018-03-26 02:16:48,937] global_step/sec: 2.47466
INFO:tensorflow:step = 223438, loss = 5.2991257 (40.410 sec)
[2018-03-26 02:16:48,939] step = 223438, loss = 5.2991257 (40.410 sec)
INFO:tensorflow:Saving checkpoints for 223537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:17:28,859] Saving checkpoints for 223537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.6687512.
[2018-03-26 02:17:33,393] Loss for final step: 4.6687512.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:17:33,394] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:17:33,405] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:17:33,406] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:17:33,487] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:17:33,571] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:17:37,233] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:17:37,233] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:17:37,233] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:17:37,233] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:17:37,233] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:17:37,233] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:17:37,234] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:17:37,280] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:17:37,404] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:17:37,415] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:17:44,648] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:17:44,727] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:17:44,743] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:17:44,753] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:17:49,222] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:17:49,515] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:17:49
[2018-03-26 02:17:49,538] Starting evaluation at 2018-03-25-23:17:49
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:17:50,006] Graph was finalized.
2018-03-26 02:17:50.007158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:17:50.007464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:17:50.023371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-223537
[2018-03-26 02:17:50,023] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-223537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:17:53,770] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:17:53,898] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:18:01,225] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:18:05,398] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:18:09,661] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:18:13,886] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:18:17,956] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:18:22,140] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:18:26,288] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:18:28,919] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:18:31,638] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:18:34,217] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:18:34
[2018-03-26 02:18:34,543] Finished evaluation at 2018-03-25-23:18:34
INFO:tensorflow:Saving dict for global step 223537: global_step = 223537, loss = 4.419217, metrics-translate_en_to_ru/approx_bleu_score = 0.13294242, metrics-translate_en_to_ru/neg_log_perplexity = -5.051938
[2018-03-26 02:18:34,545] Saving dict for global step 223537: global_step = 223537, loss = 4.419217, metrics-translate_en_to_ru/approx_bleu_score = 0.13294242, metrics-translate_en_to_ru/neg_log_perplexity = -5.051938
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:18:34,547] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:18:34,567] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:18:34,569] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:18:34,721] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:18:38,577] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:18:38,579] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:18:38,642] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:18:39,482] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:18:39,493] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:18:46,107] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:18:46,193] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:18:46,211] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:18:46,221] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:18:51,171] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:18:51,262] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:18:51,273] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:18:51,274] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:19:07,046] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:19:07,048] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:19:08,170] Graph was finalized.
2018-03-26 02:19:08.170862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:19:08.171203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:19:08.173552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-223537
[2018-03-26 02:19:08,175] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-223537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:19:12,285] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:19:12,662] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 223538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:19:43,629] Saving checkpoints for 223538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 223538, loss = 4.59212
[2018-03-26 02:19:47,949] step = 223538, loss = 4.59212
INFO:tensorflow:global_step/sec: 2.02875
[2018-03-26 02:20:37,240] global_step/sec: 2.02875
INFO:tensorflow:step = 223638, loss = 4.4997663 (49.293 sec)
[2018-03-26 02:20:37,242] step = 223638, loss = 4.4997663 (49.293 sec)
INFO:tensorflow:global_step/sec: 2.46923
[2018-03-26 02:21:17,738] global_step/sec: 2.46923
INFO:tensorflow:step = 223738, loss = 5.4973283 (40.499 sec)
[2018-03-26 02:21:17,741] step = 223738, loss = 5.4973283 (40.499 sec)
INFO:tensorflow:global_step/sec: 2.48588
[2018-03-26 02:21:57,965] global_step/sec: 2.48588
INFO:tensorflow:step = 223838, loss = 4.501497 (40.227 sec)
[2018-03-26 02:21:57,968] step = 223838, loss = 4.501497 (40.227 sec)
INFO:tensorflow:global_step/sec: 2.47497
[2018-03-26 02:22:38,370] global_step/sec: 2.47497
INFO:tensorflow:step = 223938, loss = 4.6827874 (40.405 sec)
[2018-03-26 02:22:38,372] step = 223938, loss = 4.6827874 (40.405 sec)
INFO:tensorflow:global_step/sec: 2.4876
[2018-03-26 02:23:18,570] global_step/sec: 2.4876
INFO:tensorflow:step = 224038, loss = 4.389283 (40.200 sec)
[2018-03-26 02:23:18,572] step = 224038, loss = 4.389283 (40.200 sec)
INFO:tensorflow:global_step/sec: 2.44515
[2018-03-26 02:23:59,467] global_step/sec: 2.44515
INFO:tensorflow:step = 224138, loss = 4.253005 (40.897 sec)
[2018-03-26 02:23:59,469] step = 224138, loss = 4.253005 (40.897 sec)
INFO:tensorflow:global_step/sec: 2.47016
[2018-03-26 02:24:39,950] global_step/sec: 2.47016
INFO:tensorflow:step = 224238, loss = 4.3515463 (40.483 sec)
[2018-03-26 02:24:39,952] step = 224238, loss = 4.3515463 (40.483 sec)
INFO:tensorflow:global_step/sec: 2.46928
[2018-03-26 02:25:20,447] global_step/sec: 2.46928
INFO:tensorflow:step = 224338, loss = 4.0583415 (40.498 sec)
[2018-03-26 02:25:20,449] step = 224338, loss = 4.0583415 (40.498 sec)
INFO:tensorflow:global_step/sec: 2.4723
[2018-03-26 02:26:00,896] global_step/sec: 2.4723
INFO:tensorflow:step = 224438, loss = 4.6128125 (40.448 sec)
[2018-03-26 02:26:00,898] step = 224438, loss = 4.6128125 (40.448 sec)
INFO:tensorflow:Saving checkpoints for 224537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:26:41,241] Saving checkpoints for 224537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.3293967.
[2018-03-26 02:26:45,796] Loss for final step: 4.3293967.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:26:45,798] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:26:45,806] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:26:45,809] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:26:45,878] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:26:45,954] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:26:48,916] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:26:48,916] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:26:48,916] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:26:48,916] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:26:48,917] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:26:48,917] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:26:48,917] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:26:48,952] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:26:50,156] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:26:50,164] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:26:55,038] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:26:55,106] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:26:55,120] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:26:55,127] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:26:58,817] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:26:59,094] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:26:59
[2018-03-26 02:26:59,114] Starting evaluation at 2018-03-25-23:26:59
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:26:59,508] Graph was finalized.
2018-03-26 02:26:59.508409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:26:59.508661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:26:59.508960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-224537
[2018-03-26 02:26:59,509] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-224537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:27:00,823] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:27:00,932] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:27:08,058] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:27:12,199] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:27:16,357] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:27:20,505] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:27:24,740] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:27:28,897] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:27:33,018] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:27:35,741] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:27:38,448] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:27:41,066] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:27:41
[2018-03-26 02:27:41,358] Finished evaluation at 2018-03-25-23:27:41
INFO:tensorflow:Saving dict for global step 224537: global_step = 224537, loss = 4.3264904, metrics-translate_en_to_ru/approx_bleu_score = 0.1397214, metrics-translate_en_to_ru/neg_log_perplexity = -4.94224
[2018-03-26 02:27:41,363] Saving dict for global step 224537: global_step = 224537, loss = 4.3264904, metrics-translate_en_to_ru/approx_bleu_score = 0.1397214, metrics-translate_en_to_ru/neg_log_perplexity = -4.94224
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:27:41,364] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:27:41,377] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:27:41,379] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:27:41,514] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:27:44,520] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:27:44,520] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:27:44,555] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:27:44,651] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:27:44,658] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:27:50,525] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:27:50,593] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:27:50,606] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:27:50,614] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:27:54,484] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:27:54,559] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:27:54,569] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:27:54,569] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:28:06,572] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:28:06,573] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:28:07,884] Graph was finalized.
2018-03-26 02:28:07.885427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:28:07.885787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:28:07.886140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-224537
[2018-03-26 02:28:07,887] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-224537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:28:11,199] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:28:11,437] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 224538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:28:39,004] Saving checkpoints for 224538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 224538, loss = 4.39763
[2018-03-26 02:28:42,988] step = 224538, loss = 4.39763
INFO:tensorflow:global_step/sec: 2.1154
[2018-03-26 02:29:30,260] global_step/sec: 2.1154
INFO:tensorflow:step = 224638, loss = 4.2893276 (47.274 sec)
[2018-03-26 02:29:30,262] step = 224638, loss = 4.2893276 (47.274 sec)
INFO:tensorflow:global_step/sec: 2.47746
[2018-03-26 02:30:10,624] global_step/sec: 2.47746
INFO:tensorflow:step = 224738, loss = 4.4596434 (40.364 sec)
[2018-03-26 02:30:10,626] step = 224738, loss = 4.4596434 (40.364 sec)
INFO:tensorflow:global_step/sec: 2.48244
[2018-03-26 02:30:50,907] global_step/sec: 2.48244
INFO:tensorflow:step = 224838, loss = 4.3133984 (40.283 sec)
[2018-03-26 02:30:50,909] step = 224838, loss = 4.3133984 (40.283 sec)
INFO:tensorflow:global_step/sec: 2.47222
[2018-03-26 02:31:31,356] global_step/sec: 2.47222
INFO:tensorflow:step = 224938, loss = 4.3022556 (40.449 sec)
[2018-03-26 02:31:31,358] step = 224938, loss = 4.3022556 (40.449 sec)
INFO:tensorflow:global_step/sec: 2.44162
[2018-03-26 02:32:12,312] global_step/sec: 2.44162
INFO:tensorflow:step = 225038, loss = 4.4368844 (40.957 sec)
[2018-03-26 02:32:12,315] step = 225038, loss = 4.4368844 (40.957 sec)
INFO:tensorflow:global_step/sec: 2.47275
[2018-03-26 02:32:52,753] global_step/sec: 2.47275
INFO:tensorflow:step = 225138, loss = 4.547522 (40.440 sec)
[2018-03-26 02:32:52,755] step = 225138, loss = 4.547522 (40.440 sec)
INFO:tensorflow:global_step/sec: 2.44588
[2018-03-26 02:33:33,638] global_step/sec: 2.44588
INFO:tensorflow:step = 225238, loss = 4.277432 (40.885 sec)
[2018-03-26 02:33:33,639] step = 225238, loss = 4.277432 (40.885 sec)
INFO:tensorflow:global_step/sec: 2.47062
[2018-03-26 02:34:14,114] global_step/sec: 2.47062
INFO:tensorflow:step = 225338, loss = 4.5227947 (40.476 sec)
[2018-03-26 02:34:14,116] step = 225338, loss = 4.5227947 (40.476 sec)
INFO:tensorflow:global_step/sec: 2.46456
[2018-03-26 02:34:54,689] global_step/sec: 2.46456
INFO:tensorflow:step = 225438, loss = 4.6435747 (40.575 sec)
[2018-03-26 02:34:54,691] step = 225438, loss = 4.6435747 (40.575 sec)
INFO:tensorflow:Saving checkpoints for 225537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:35:34,854] Saving checkpoints for 225537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.308024.
[2018-03-26 02:35:39,447] Loss for final step: 4.308024.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:35:39,449] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:35:39,462] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:35:39,465] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:35:39,559] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:35:39,641] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:35:43,142] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:35:43,142] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:35:43,142] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:35:43,143] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:35:43,143] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:35:43,143] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:35:43,143] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:35:43,190] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:35:43,302] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:35:43,311] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:35:49,904] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:35:49,978] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:35:49,993] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:35:50,002] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:35:54,063] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:35:54,328] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:35:54
[2018-03-26 02:35:54,346] Starting evaluation at 2018-03-25-23:35:54
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:35:54,734] Graph was finalized.
2018-03-26 02:35:54.734550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:35:54.735936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:35:54.736350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-225537
[2018-03-26 02:35:54,736] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-225537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:35:56,253] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:35:56,380] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:36:03,840] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:36:07,981] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:36:12,149] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:36:16,364] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:36:20,552] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:36:24,768] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:36:29,034] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:36:31,718] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:36:34,327] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:36:36,974] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:36:37
[2018-03-26 02:36:37,268] Finished evaluation at 2018-03-25-23:36:37
INFO:tensorflow:Saving dict for global step 225537: global_step = 225537, loss = 4.2423844, metrics-translate_en_to_ru/approx_bleu_score = 0.146203, metrics-translate_en_to_ru/neg_log_perplexity = -4.839168
[2018-03-26 02:36:37,270] Saving dict for global step 225537: global_step = 225537, loss = 4.2423844, metrics-translate_en_to_ru/approx_bleu_score = 0.146203, metrics-translate_en_to_ru/neg_log_perplexity = -4.839168
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:36:37,272] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:36:37,291] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:36:37,293] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:36:37,430] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:36:40,914] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:36:40,915] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:36:40,966] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:36:41,074] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:36:41,084] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:36:47,661] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:36:47,730] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:36:47,744] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:36:47,752] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:36:51,788] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:36:51,865] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:36:51,876] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:36:51,877] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:37:04,338] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:37:04,339] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:37:05,179] Graph was finalized.
2018-03-26 02:37:05.179996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:37:05.180304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:37:05.180668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-225537
[2018-03-26 02:37:05,182] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-225537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:37:08,493] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:37:08,742] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 225538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:37:35,061] Saving checkpoints for 225538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 225538, loss = 4.376639
[2018-03-26 02:37:39,051] step = 225538, loss = 4.376639
INFO:tensorflow:global_step/sec: 2.10107
[2018-03-26 02:38:26,645] global_step/sec: 2.10107
INFO:tensorflow:step = 225638, loss = 3.781188 (47.597 sec)
[2018-03-26 02:38:26,647] step = 225638, loss = 3.781188 (47.597 sec)
INFO:tensorflow:global_step/sec: 2.47143
[2018-03-26 02:39:07,108] global_step/sec: 2.47143
INFO:tensorflow:step = 225738, loss = 3.9716582 (40.462 sec)
[2018-03-26 02:39:07,109] step = 225738, loss = 3.9716582 (40.462 sec)
INFO:tensorflow:global_step/sec: 2.48286
[2018-03-26 02:39:47,384] global_step/sec: 2.48286
INFO:tensorflow:step = 225838, loss = 4.165087 (40.277 sec)
[2018-03-26 02:39:47,386] step = 225838, loss = 4.165087 (40.277 sec)
INFO:tensorflow:global_step/sec: 2.4692
[2018-03-26 02:40:27,882] global_step/sec: 2.4692
INFO:tensorflow:step = 225938, loss = 4.4214907 (40.498 sec)
[2018-03-26 02:40:27,884] step = 225938, loss = 4.4214907 (40.498 sec)
INFO:tensorflow:global_step/sec: 2.49202
[2018-03-26 02:41:08,011] global_step/sec: 2.49202
INFO:tensorflow:step = 226038, loss = 4.2780905 (40.129 sec)
[2018-03-26 02:41:08,013] step = 226038, loss = 4.2780905 (40.129 sec)
INFO:tensorflow:global_step/sec: 2.45502
[2018-03-26 02:41:48,744] global_step/sec: 2.45502
INFO:tensorflow:step = 226138, loss = 4.2727776 (40.733 sec)
[2018-03-26 02:41:48,746] step = 226138, loss = 4.2727776 (40.733 sec)
INFO:tensorflow:global_step/sec: 2.48626
[2018-03-26 02:42:28,965] global_step/sec: 2.48626
INFO:tensorflow:step = 226238, loss = 4.359894 (40.221 sec)
[2018-03-26 02:42:28,967] step = 226238, loss = 4.359894 (40.221 sec)
INFO:tensorflow:global_step/sec: 2.48347
[2018-03-26 02:43:09,231] global_step/sec: 2.48347
INFO:tensorflow:step = 226338, loss = 4.29902 (40.266 sec)
[2018-03-26 02:43:09,232] step = 226338, loss = 4.29902 (40.266 sec)
INFO:tensorflow:global_step/sec: 2.46553
[2018-03-26 02:43:49,790] global_step/sec: 2.46553
INFO:tensorflow:step = 226438, loss = 4.3693824 (40.559 sec)
[2018-03-26 02:43:49,792] step = 226438, loss = 4.3693824 (40.559 sec)
INFO:tensorflow:Saving checkpoints for 226537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:44:30,384] Saving checkpoints for 226537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.188781.
[2018-03-26 02:44:38,869] Loss for final step: 4.188781.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:44:38,871] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:44:38,889] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:44:38,893] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:44:39,002] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:44:39,121] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:44:45,298] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:44:45,298] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:44:45,298] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:44:45,298] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:44:45,299] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:44:45,299] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:44:45,300] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:44:45,365] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:44:45,549] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:44:45,566] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:44:57,370] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:44:57,539] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:44:57,566] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:44:57,581] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:45:05,122] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:45:05,655] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:45:05
[2018-03-26 02:45:05,689] Starting evaluation at 2018-03-25-23:45:05
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:45:06,429] Graph was finalized.
2018-03-26 02:45:06.430395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:45:06.430841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:45:06.444906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-226537
[2018-03-26 02:45:06,445] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-226537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:45:08,869] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:45:09,088] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:45:20,403] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:45:26,296] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:45:32,259] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:45:38,174] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:45:44,116] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:45:49,891] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:45:55,709] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:45:59,441] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:46:03,156] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:46:06,527] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:46:07
[2018-03-26 02:46:07,059] Finished evaluation at 2018-03-25-23:46:07
INFO:tensorflow:Saving dict for global step 226537: global_step = 226537, loss = 4.164516, metrics-translate_en_to_ru/approx_bleu_score = 0.15209982, metrics-translate_en_to_ru/neg_log_perplexity = -4.749888
[2018-03-26 02:46:07,062] Saving dict for global step 226537: global_step = 226537, loss = 4.164516, metrics-translate_en_to_ru/approx_bleu_score = 0.15209982, metrics-translate_en_to_ru/neg_log_perplexity = -4.749888
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:46:07,066] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:46:07,102] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:46:07,105] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:46:07,348] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:46:12,879] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:46:12,880] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:46:12,923] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:46:13,033] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:46:13,042] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:46:22,837] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:46:22,941] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:46:22,969] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:46:22,985] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:46:30,866] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:46:30,960] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:46:30,973] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:46:30,974] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:46:47,398] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:46:47,399] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:46:48,465] Graph was finalized.
2018-03-26 02:46:48.465920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:46:48.467363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:46:48.480929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-226537
[2018-03-26 02:46:48,483] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-226537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:46:55,273] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:46:55,708] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 226538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:47:38,326] Saving checkpoints for 226538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 226538, loss = 4.0700946
[2018-03-26 02:47:45,353] step = 226538, loss = 4.0700946
INFO:tensorflow:global_step/sec: 1.88656
[2018-03-26 02:48:38,359] global_step/sec: 1.88656
INFO:tensorflow:step = 226638, loss = 4.262668 (53.008 sec)
[2018-03-26 02:48:38,361] step = 226638, loss = 4.262668 (53.008 sec)
INFO:tensorflow:global_step/sec: 2.47224
[2018-03-26 02:49:18,808] global_step/sec: 2.47224
INFO:tensorflow:step = 226738, loss = 4.327391 (40.448 sec)
[2018-03-26 02:49:18,809] step = 226738, loss = 4.327391 (40.448 sec)
INFO:tensorflow:global_step/sec: 2.44932
[2018-03-26 02:49:59,636] global_step/sec: 2.44932
INFO:tensorflow:step = 226838, loss = 4.208893 (40.832 sec)
[2018-03-26 02:49:59,641] step = 226838, loss = 4.208893 (40.832 sec)
INFO:tensorflow:global_step/sec: 2.47958
[2018-03-26 02:50:39,965] global_step/sec: 2.47958
INFO:tensorflow:step = 226938, loss = 3.965109 (40.326 sec)
[2018-03-26 02:50:39,967] step = 226938, loss = 3.965109 (40.326 sec)
INFO:tensorflow:global_step/sec: 2.4508
[2018-03-26 02:51:20,768] global_step/sec: 2.4508
INFO:tensorflow:step = 227038, loss = 4.362074 (40.803 sec)
[2018-03-26 02:51:20,770] step = 227038, loss = 4.362074 (40.803 sec)
INFO:tensorflow:global_step/sec: 2.46067
[2018-03-26 02:52:01,408] global_step/sec: 2.46067
INFO:tensorflow:step = 227138, loss = 4.4540052 (40.640 sec)
[2018-03-26 02:52:01,410] step = 227138, loss = 4.4540052 (40.640 sec)
INFO:tensorflow:global_step/sec: 2.4637
[2018-03-26 02:52:41,997] global_step/sec: 2.4637
INFO:tensorflow:step = 227238, loss = 4.110253 (40.589 sec)
[2018-03-26 02:52:41,999] step = 227238, loss = 4.110253 (40.589 sec)
INFO:tensorflow:global_step/sec: 2.46112
[2018-03-26 02:53:22,629] global_step/sec: 2.46112
INFO:tensorflow:step = 227338, loss = 3.988556 (40.632 sec)
[2018-03-26 02:53:22,631] step = 227338, loss = 3.988556 (40.632 sec)
INFO:tensorflow:global_step/sec: 2.46642
[2018-03-26 02:54:03,173] global_step/sec: 2.46642
INFO:tensorflow:step = 227438, loss = 4.3495517 (40.544 sec)
[2018-03-26 02:54:03,175] step = 227438, loss = 4.3495517 (40.544 sec)
INFO:tensorflow:Saving checkpoints for 227537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:54:45,110] Saving checkpoints for 227537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.0716724.
[2018-03-26 02:54:56,400] Loss for final step: 4.0716724.
INFO:tensorflow:Evaluating model now.
[2018-03-26 02:54:56,404] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 02:54:56,427] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 02:54:56,434] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 02:54:56,596] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:54:56,758] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 02:55:05,746] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 02:55:05,748] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 02:55:05,748] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 02:55:05,748] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 02:55:05,748] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 02:55:05,748] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:55:05,750] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:55:05,887] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:55:06,163] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:55:06,190] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:55:19,515] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:55:19,698] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:55:19,736] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:55:19,756] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:55:30,263] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:55:30,582] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-25-23:55:30
[2018-03-26 02:55:30,605] Starting evaluation at 2018-03-25-23:55:30
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:55:31,048] Graph was finalized.
2018-03-26 02:55:31.048808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:55:31.049125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:55:31.049527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-227537
[2018-03-26 02:55:31,049] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-227537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:55:32,795] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:55:32,936] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 02:55:41,613] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 02:55:46,386] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 02:55:51,147] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 02:55:55,939] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 02:56:00,766] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 02:56:05,560] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 02:56:10,397] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 02:56:13,526] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 02:56:16,645] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 02:56:19,721] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-25-23:56:20
[2018-03-26 02:56:20,109] Finished evaluation at 2018-03-25-23:56:20
INFO:tensorflow:Saving dict for global step 227537: global_step = 227537, loss = 4.105437, metrics-translate_en_to_ru/approx_bleu_score = 0.15717348, metrics-translate_en_to_ru/neg_log_perplexity = -4.6734834
[2018-03-26 02:56:20,111] Saving dict for global step 227537: global_step = 227537, loss = 4.105437, metrics-translate_en_to_ru/approx_bleu_score = 0.15717348, metrics-translate_en_to_ru/neg_log_perplexity = -4.6734834
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 02:56:20,114] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 02:56:20,138] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 02:56:20,142] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 02:56:20,381] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 02:56:24,699] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 02:56:24,700] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:56:24,749] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:56:26,034] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:56:26,045] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:56:33,892] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 02:56:34,003] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 02:56:34,027] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 02:56:34,039] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 02:56:39,341] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 02:56:39,424] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 02:56:39,436] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 02:56:39,437] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 02:56:53,840] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 02:56:53,841] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 02:56:54,940] Graph was finalized.
2018-03-26 02:56:54.940637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 02:56:54.940938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 02:56:54.941297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-227537
[2018-03-26 02:56:54,942] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-227537
INFO:tensorflow:Running local_init_op.
[2018-03-26 02:56:58,487] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 02:56:58,739] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 227538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 02:57:28,609] Saving checkpoints for 227538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 227538, loss = 4.1450753
[2018-03-26 02:57:32,691] step = 227538, loss = 4.1450753
INFO:tensorflow:global_step/sec: 2.07466
[2018-03-26 02:58:20,891] global_step/sec: 2.07466
INFO:tensorflow:step = 227638, loss = 4.109861 (48.202 sec)
[2018-03-26 02:58:20,893] step = 227638, loss = 4.109861 (48.202 sec)
INFO:tensorflow:global_step/sec: 2.49026
[2018-03-26 02:59:01,047] global_step/sec: 2.49026
INFO:tensorflow:step = 227738, loss = 4.0982304 (40.156 sec)
[2018-03-26 02:59:01,049] step = 227738, loss = 4.0982304 (40.156 sec)
INFO:tensorflow:global_step/sec: 2.49661
[2018-03-26 02:59:41,102] global_step/sec: 2.49661
INFO:tensorflow:step = 227838, loss = 4.3069925 (40.055 sec)
[2018-03-26 02:59:41,104] step = 227838, loss = 4.3069925 (40.055 sec)
INFO:tensorflow:global_step/sec: 2.45049
[2018-03-26 03:00:21,913] global_step/sec: 2.45049
INFO:tensorflow:step = 227938, loss = 4.3562274 (40.811 sec)
[2018-03-26 03:00:21,915] step = 227938, loss = 4.3562274 (40.811 sec)
INFO:tensorflow:global_step/sec: 2.48727
[2018-03-26 03:01:02,115] global_step/sec: 2.48727
INFO:tensorflow:step = 228038, loss = 3.9648826 (40.202 sec)
[2018-03-26 03:01:02,117] step = 228038, loss = 3.9648826 (40.202 sec)
INFO:tensorflow:global_step/sec: 2.46893
[2018-03-26 03:01:42,619] global_step/sec: 2.46893
INFO:tensorflow:step = 228138, loss = 4.2862344 (40.505 sec)
[2018-03-26 03:01:42,622] step = 228138, loss = 4.2862344 (40.505 sec)
INFO:tensorflow:global_step/sec: 2.47223
[2018-03-26 03:02:23,067] global_step/sec: 2.47223
INFO:tensorflow:step = 228238, loss = 4.088586 (40.447 sec)
[2018-03-26 03:02:23,069] step = 228238, loss = 4.088586 (40.447 sec)
INFO:tensorflow:global_step/sec: 2.47894
[2018-03-26 03:03:03,407] global_step/sec: 2.47894
INFO:tensorflow:step = 228338, loss = 3.939931 (40.340 sec)
[2018-03-26 03:03:03,409] step = 228338, loss = 3.939931 (40.340 sec)
INFO:tensorflow:global_step/sec: 2.4713
[2018-03-26 03:03:43,872] global_step/sec: 2.4713
INFO:tensorflow:step = 228438, loss = 4.3673472 (40.465 sec)
[2018-03-26 03:03:43,874] step = 228438, loss = 4.3673472 (40.465 sec)
INFO:tensorflow:Saving checkpoints for 228537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:04:23,747] Saving checkpoints for 228537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.9165242.
[2018-03-26 03:04:28,603] Loss for final step: 3.9165242.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:04:28,605] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:04:28,616] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:04:28,618] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:04:28,700] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:04:28,775] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:04:32,679] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:04:32,679] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:04:32,679] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:04:32,679] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:04:32,680] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:04:32,680] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:04:32,681] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:04:34,062] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:04:34,212] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:04:34,222] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:04:40,855] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:04:40,929] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:04:40,944] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:04:40,952] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:04:45,499] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:04:45,778] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:04:45
[2018-03-26 03:04:45,797] Starting evaluation at 2018-03-26-00:04:45
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:04:46,359] Graph was finalized.
2018-03-26 03:04:46.360095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:04:46.361370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:04:46.376335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-228537
[2018-03-26 03:04:46,376] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-228537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:04:47,811] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:04:47,910] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:04:55,392] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:05:00,193] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:05:04,408] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:05:08,683] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:05:13,001] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:05:17,157] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:05:21,373] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:05:24,122] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:05:26,829] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:05:29,395] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:05:29
[2018-03-26 03:05:29,694] Finished evaluation at 2018-03-26-00:05:29
INFO:tensorflow:Saving dict for global step 228537: global_step = 228537, loss = 4.0463676, metrics-translate_en_to_ru/approx_bleu_score = 0.16273423, metrics-translate_en_to_ru/neg_log_perplexity = -4.5993166
[2018-03-26 03:05:29,697] Saving dict for global step 228537: global_step = 228537, loss = 4.0463676, metrics-translate_en_to_ru/approx_bleu_score = 0.16273423, metrics-translate_en_to_ru/neg_log_perplexity = -4.5993166
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:05:29,704] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:05:29,725] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:05:29,727] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:05:29,895] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:05:33,531] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:05:33,532] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:05:33,577] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:05:33,692] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:05:33,701] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:05:40,714] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:05:40,795] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:05:40,813] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:05:40,823] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:05:45,508] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:05:45,598] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:05:45,609] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:05:45,610] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:06:00,015] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:06:00,016] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:06:01,198] Graph was finalized.
2018-03-26 03:06:01.199009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:06:01.200724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:06:01.219214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-228537
[2018-03-26 03:06:01,220] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-228537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:06:04,772] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:06:05,022] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 228538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:06:36,859] Saving checkpoints for 228538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 228538, loss = 4.0412126
[2018-03-26 03:06:41,224] step = 228538, loss = 4.0412126
INFO:tensorflow:global_step/sec: 2.06417
[2018-03-26 03:07:29,669] global_step/sec: 2.06417
INFO:tensorflow:step = 228638, loss = 3.7779315 (48.447 sec)
[2018-03-26 03:07:29,670] step = 228638, loss = 3.7779315 (48.447 sec)
INFO:tensorflow:global_step/sec: 2.47233
[2018-03-26 03:08:10,116] global_step/sec: 2.47233
INFO:tensorflow:step = 228738, loss = 3.679611 (40.448 sec)
[2018-03-26 03:08:10,119] step = 228738, loss = 3.679611 (40.448 sec)
INFO:tensorflow:global_step/sec: 2.47911
[2018-03-26 03:08:50,453] global_step/sec: 2.47911
INFO:tensorflow:step = 228838, loss = 4.112729 (40.337 sec)
[2018-03-26 03:08:50,455] step = 228838, loss = 4.112729 (40.337 sec)
INFO:tensorflow:global_step/sec: 2.47141
[2018-03-26 03:09:30,916] global_step/sec: 2.47141
INFO:tensorflow:step = 228938, loss = 3.9157007 (40.462 sec)
[2018-03-26 03:09:30,917] step = 228938, loss = 3.9157007 (40.462 sec)
INFO:tensorflow:global_step/sec: 2.46382
[2018-03-26 03:10:11,504] global_step/sec: 2.46382
INFO:tensorflow:step = 229038, loss = 3.9504056 (40.588 sec)
[2018-03-26 03:10:11,506] step = 229038, loss = 3.9504056 (40.588 sec)
INFO:tensorflow:global_step/sec: 2.46204
[2018-03-26 03:10:52,120] global_step/sec: 2.46204
INFO:tensorflow:step = 229138, loss = 3.9649332 (40.617 sec)
[2018-03-26 03:10:52,122] step = 229138, loss = 3.9649332 (40.617 sec)
INFO:tensorflow:global_step/sec: 2.45825
[2018-03-26 03:11:32,800] global_step/sec: 2.45825
INFO:tensorflow:step = 229238, loss = 3.711444 (40.679 sec)
[2018-03-26 03:11:32,801] step = 229238, loss = 3.711444 (40.679 sec)
INFO:tensorflow:global_step/sec: 2.45348
[2018-03-26 03:12:13,558] global_step/sec: 2.45348
INFO:tensorflow:step = 229338, loss = 4.0891733 (40.758 sec)
[2018-03-26 03:12:13,559] step = 229338, loss = 4.0891733 (40.758 sec)
INFO:tensorflow:global_step/sec: 2.44797
[2018-03-26 03:12:54,408] global_step/sec: 2.44797
INFO:tensorflow:step = 229438, loss = 3.9671688 (40.851 sec)
[2018-03-26 03:12:54,411] step = 229438, loss = 3.9671688 (40.851 sec)
INFO:tensorflow:Saving checkpoints for 229537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:13:34,651] Saving checkpoints for 229537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.8036048.
[2018-03-26 03:13:39,234] Loss for final step: 3.8036048.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:13:39,235] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:13:39,243] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:13:39,246] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:13:39,314] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:13:39,389] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:13:42,502] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:13:42,502] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:13:42,502] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:13:42,502] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:13:42,502] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:13:42,502] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:13:42,503] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:13:42,537] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:13:42,628] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:13:42,636] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:13:48,656] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:13:48,731] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:13:48,747] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:13:48,755] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:13:52,476] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:13:53,027] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:13:53
[2018-03-26 03:13:53,046] Starting evaluation at 2018-03-26-00:13:53
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:13:53,418] Graph was finalized.
2018-03-26 03:13:53.418855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:13:53.419120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:13:53.419404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-229537
[2018-03-26 03:13:53,419] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-229537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:13:54,801] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:13:54,957] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:14:02,097] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:14:06,254] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:14:10,469] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:14:14,696] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:14:18,856] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:14:23,085] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:14:27,278] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:14:29,972] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:14:32,622] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:14:35,234] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:14:35
[2018-03-26 03:14:35,535] Finished evaluation at 2018-03-26-00:14:35
INFO:tensorflow:Saving dict for global step 229537: global_step = 229537, loss = 3.9813743, metrics-translate_en_to_ru/approx_bleu_score = 0.1673421, metrics-translate_en_to_ru/neg_log_perplexity = -4.5263247
[2018-03-26 03:14:35,537] Saving dict for global step 229537: global_step = 229537, loss = 3.9813743, metrics-translate_en_to_ru/approx_bleu_score = 0.1673421, metrics-translate_en_to_ru/neg_log_perplexity = -4.5263247
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:14:35,538] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:14:35,557] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:14:35,559] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:14:35,736] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:14:39,623] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:14:39,624] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:14:39,670] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:14:39,791] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:14:39,802] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:14:46,703] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:14:46,785] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:14:46,802] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:14:46,812] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:14:51,495] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:14:51,589] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:14:51,601] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:14:51,601] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:15:07,049] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:15:07,050] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:15:08,115] Graph was finalized.
2018-03-26 03:15:08.116179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:15:08.119082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:15:08.119763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-229537
[2018-03-26 03:15:08,122] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-229537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:15:11,805] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:15:12,057] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 229538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:15:41,559] Saving checkpoints for 229538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 229538, loss = 3.8926291
[2018-03-26 03:15:45,767] step = 229538, loss = 3.8926291
INFO:tensorflow:global_step/sec: 2.07101
[2018-03-26 03:16:34,052] global_step/sec: 2.07101
INFO:tensorflow:step = 229638, loss = 3.8073542 (48.287 sec)
[2018-03-26 03:16:34,054] step = 229638, loss = 3.8073542 (48.287 sec)
INFO:tensorflow:global_step/sec: 2.47124
[2018-03-26 03:17:14,518] global_step/sec: 2.47124
INFO:tensorflow:step = 229738, loss = 4.1029253 (40.466 sec)
[2018-03-26 03:17:14,520] step = 229738, loss = 4.1029253 (40.466 sec)
INFO:tensorflow:global_step/sec: 2.46889
[2018-03-26 03:17:55,022] global_step/sec: 2.46889
INFO:tensorflow:step = 229838, loss = 4.026506 (40.503 sec)
[2018-03-26 03:17:55,024] step = 229838, loss = 4.026506 (40.503 sec)
INFO:tensorflow:global_step/sec: 2.4236
[2018-03-26 03:18:36,283] global_step/sec: 2.4236
INFO:tensorflow:step = 229938, loss = 3.9494708 (41.262 sec)
[2018-03-26 03:18:36,285] step = 229938, loss = 3.9494708 (41.262 sec)
INFO:tensorflow:global_step/sec: 2.44451
[2018-03-26 03:19:17,191] global_step/sec: 2.44451
INFO:tensorflow:step = 230038, loss = 4.158924 (40.908 sec)
[2018-03-26 03:19:17,193] step = 230038, loss = 4.158924 (40.908 sec)
INFO:tensorflow:global_step/sec: 2.44934
[2018-03-26 03:19:58,018] global_step/sec: 2.44934
INFO:tensorflow:step = 230138, loss = 4.4686313 (40.827 sec)
[2018-03-26 03:19:58,020] step = 230138, loss = 4.4686313 (40.827 sec)
INFO:tensorflow:global_step/sec: 2.47296
[2018-03-26 03:20:38,458] global_step/sec: 2.47296
INFO:tensorflow:step = 230238, loss = 4.046404 (40.442 sec)
[2018-03-26 03:20:38,463] step = 230238, loss = 4.046404 (40.442 sec)
INFO:tensorflow:global_step/sec: 2.45399
[2018-03-26 03:21:19,206] global_step/sec: 2.45399
INFO:tensorflow:step = 230338, loss = 3.5681217 (40.746 sec)
[2018-03-26 03:21:19,208] step = 230338, loss = 3.5681217 (40.746 sec)
INFO:tensorflow:global_step/sec: 2.47096
[2018-03-26 03:21:59,675] global_step/sec: 2.47096
INFO:tensorflow:step = 230438, loss = 4.114794 (40.469 sec)
[2018-03-26 03:21:59,677] step = 230438, loss = 4.114794 (40.469 sec)
INFO:tensorflow:Saving checkpoints for 230537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:22:39,651] Saving checkpoints for 230537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 4.1595445.
[2018-03-26 03:22:43,689] Loss for final step: 4.1595445.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:22:43,690] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:22:43,700] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:22:43,703] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:22:43,772] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:22:43,849] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:22:47,304] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:22:47,304] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:22:47,304] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:22:47,305] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:22:47,305] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:22:47,305] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:22:47,305] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:22:47,348] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:22:47,456] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:22:47,466] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:22:54,160] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:22:54,245] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:22:54,263] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:22:54,272] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:22:58,233] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:22:58,498] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:22:58
[2018-03-26 03:22:58,516] Starting evaluation at 2018-03-26-00:22:58
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:22:58,889] Graph was finalized.
2018-03-26 03:22:58.889609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:22:58.891365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:22:58.898719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-230537
[2018-03-26 03:22:58,898] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-230537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:23:00,363] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:23:00,476] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:23:07,442] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:23:11,610] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:23:15,755] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:23:20,013] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:23:24,233] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:23:28,407] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:23:32,590] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:23:35,258] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:23:37,953] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:23:40,589] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:23:40
[2018-03-26 03:23:40,887] Finished evaluation at 2018-03-26-00:23:40
INFO:tensorflow:Saving dict for global step 230537: global_step = 230537, loss = 3.9248354, metrics-translate_en_to_ru/approx_bleu_score = 0.17174143, metrics-translate_en_to_ru/neg_log_perplexity = -4.460063
[2018-03-26 03:23:40,888] Saving dict for global step 230537: global_step = 230537, loss = 3.9248354, metrics-translate_en_to_ru/approx_bleu_score = 0.17174143, metrics-translate_en_to_ru/neg_log_perplexity = -4.460063
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:23:40,890] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:23:40,910] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:23:40,912] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:23:41,049] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:23:44,521] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:23:44,521] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:23:44,564] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:23:44,672] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:23:44,681] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:23:50,927] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:23:51,009] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:23:51,026] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:23:51,035] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:23:55,324] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:23:55,402] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:23:55,412] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:23:55,412] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:24:09,419] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:24:09,420] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:24:10,334] Graph was finalized.
2018-03-26 03:24:10.334738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:24:10.335054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:24:10.350399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-230537
[2018-03-26 03:24:10,352] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-230537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:24:13,811] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:24:14,060] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 230538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:24:46,854] Saving checkpoints for 230538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 230538, loss = 4.0477643
[2018-03-26 03:24:50,955] step = 230538, loss = 4.0477643
INFO:tensorflow:global_step/sec: 2.0817
[2018-03-26 03:25:38,992] global_step/sec: 2.0817
INFO:tensorflow:step = 230638, loss = 3.6446745 (48.039 sec)
[2018-03-26 03:25:38,994] step = 230638, loss = 3.6446745 (48.039 sec)
INFO:tensorflow:global_step/sec: 2.4795
[2018-03-26 03:26:19,322] global_step/sec: 2.4795
INFO:tensorflow:step = 230738, loss = 3.6044755 (40.330 sec)
[2018-03-26 03:26:19,324] step = 230738, loss = 3.6044755 (40.330 sec)
INFO:tensorflow:global_step/sec: 2.48002
[2018-03-26 03:26:59,645] global_step/sec: 2.48002
INFO:tensorflow:step = 230838, loss = 4.0252886 (40.322 sec)
[2018-03-26 03:26:59,646] step = 230838, loss = 4.0252886 (40.322 sec)
INFO:tensorflow:global_step/sec: 2.47676
[2018-03-26 03:27:40,020] global_step/sec: 2.47676
INFO:tensorflow:step = 230938, loss = 3.9344215 (40.375 sec)
[2018-03-26 03:27:40,021] step = 230938, loss = 3.9344215 (40.375 sec)
INFO:tensorflow:global_step/sec: 2.44261
[2018-03-26 03:28:20,960] global_step/sec: 2.44261
INFO:tensorflow:step = 231038, loss = 3.971656 (40.941 sec)
[2018-03-26 03:28:20,962] step = 231038, loss = 3.971656 (40.941 sec)
INFO:tensorflow:global_step/sec: 2.46427
[2018-03-26 03:29:01,540] global_step/sec: 2.46427
INFO:tensorflow:step = 231138, loss = 4.055522 (40.580 sec)
[2018-03-26 03:29:01,542] step = 231138, loss = 4.055522 (40.580 sec)
INFO:tensorflow:global_step/sec: 2.46147
[2018-03-26 03:29:42,166] global_step/sec: 2.46147
INFO:tensorflow:step = 231238, loss = 3.792778 (40.628 sec)
[2018-03-26 03:29:42,170] step = 231238, loss = 3.792778 (40.628 sec)
INFO:tensorflow:global_step/sec: 2.46723
[2018-03-26 03:30:22,697] global_step/sec: 2.46723
INFO:tensorflow:step = 231338, loss = 3.666708 (40.530 sec)
[2018-03-26 03:30:22,699] step = 231338, loss = 3.666708 (40.530 sec)
INFO:tensorflow:global_step/sec: 2.43257
[2018-03-26 03:31:03,806] global_step/sec: 2.43257
INFO:tensorflow:step = 231438, loss = 3.8390524 (41.109 sec)
[2018-03-26 03:31:03,809] step = 231438, loss = 3.8390524 (41.109 sec)
INFO:tensorflow:Saving checkpoints for 231537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:31:44,292] Saving checkpoints for 231537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.8983858.
[2018-03-26 03:31:49,068] Loss for final step: 3.8983858.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:31:49,070] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:31:49,081] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:31:49,084] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:31:49,179] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:31:49,258] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:31:53,134] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:31:53,134] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:31:53,135] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:31:53,135] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:31:53,135] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:31:53,135] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:31:53,136] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:31:53,204] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:31:54,776] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:31:54,788] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:32:01,136] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:32:01,227] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:32:01,246] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:32:01,255] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:32:05,748] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:32:06,054] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:32:06
[2018-03-26 03:32:06,076] Starting evaluation at 2018-03-26-00:32:06
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:32:06,504] Graph was finalized.
2018-03-26 03:32:06.505077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:32:06.506252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:32:06.506818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-231537
[2018-03-26 03:32:06,507] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-231537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:32:07,921] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:32:08,049] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:32:15,914] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:32:20,128] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:32:24,467] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:32:28,797] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:32:33,038] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:32:37,210] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:32:41,511] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:32:44,258] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:32:46,970] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:32:49,601] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:32:49
[2018-03-26 03:32:49,893] Finished evaluation at 2018-03-26-00:32:49
INFO:tensorflow:Saving dict for global step 231537: global_step = 231537, loss = 3.886286, metrics-translate_en_to_ru/approx_bleu_score = 0.17623867, metrics-translate_en_to_ru/neg_log_perplexity = -4.407985
[2018-03-26 03:32:49,896] Saving dict for global step 231537: global_step = 231537, loss = 3.886286, metrics-translate_en_to_ru/approx_bleu_score = 0.17623867, metrics-translate_en_to_ru/neg_log_perplexity = -4.407985
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:32:49,901] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:32:49,914] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:32:49,916] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:32:50,079] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:32:53,817] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:32:53,818] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:32:53,862] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:32:53,972] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:32:53,980] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:33:00,904] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:33:00,987] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:33:01,005] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:33:01,014] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:33:05,691] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:33:05,786] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:33:05,799] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:33:05,799] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:33:21,423] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:33:21,425] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:33:22,456] Graph was finalized.
2018-03-26 03:33:22.457096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:33:22.457513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:33:22.474607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-231537
[2018-03-26 03:33:22,476] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-231537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:33:26,093] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:33:26,347] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 231538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:33:57,456] Saving checkpoints for 231538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 231538, loss = 3.8676252
[2018-03-26 03:34:01,744] step = 231538, loss = 3.8676252
INFO:tensorflow:global_step/sec: 2.06341
[2018-03-26 03:34:50,207] global_step/sec: 2.06341
INFO:tensorflow:step = 231638, loss = 3.4782019 (48.465 sec)
[2018-03-26 03:34:50,209] step = 231638, loss = 3.4782019 (48.465 sec)
INFO:tensorflow:global_step/sec: 2.46586
[2018-03-26 03:35:30,761] global_step/sec: 2.46586
INFO:tensorflow:step = 231738, loss = 4.0828767 (40.554 sec)
[2018-03-26 03:35:30,763] step = 231738, loss = 4.0828767 (40.554 sec)
INFO:tensorflow:global_step/sec: 2.46748
[2018-03-26 03:36:11,288] global_step/sec: 2.46748
INFO:tensorflow:step = 231838, loss = 3.9612582 (40.527 sec)
[2018-03-26 03:36:11,290] step = 231838, loss = 3.9612582 (40.527 sec)
INFO:tensorflow:global_step/sec: 2.47556
[2018-03-26 03:36:51,683] global_step/sec: 2.47556
INFO:tensorflow:step = 231938, loss = 3.9711294 (40.395 sec)
[2018-03-26 03:36:51,685] step = 231938, loss = 3.9711294 (40.395 sec)
INFO:tensorflow:global_step/sec: 2.44392
[2018-03-26 03:37:32,601] global_step/sec: 2.44392
INFO:tensorflow:step = 232038, loss = 3.7301812 (40.918 sec)
[2018-03-26 03:37:32,603] step = 232038, loss = 3.7301812 (40.918 sec)
INFO:tensorflow:global_step/sec: 2.47279
[2018-03-26 03:38:13,041] global_step/sec: 2.47279
INFO:tensorflow:step = 232138, loss = 3.9582286 (40.440 sec)
[2018-03-26 03:38:13,043] step = 232138, loss = 3.9582286 (40.440 sec)
INFO:tensorflow:global_step/sec: 2.46365
[2018-03-26 03:38:53,631] global_step/sec: 2.46365
INFO:tensorflow:step = 232238, loss = 4.100194 (40.590 sec)
[2018-03-26 03:38:53,633] step = 232238, loss = 4.100194 (40.590 sec)
INFO:tensorflow:global_step/sec: 2.47326
[2018-03-26 03:39:34,064] global_step/sec: 2.47326
INFO:tensorflow:step = 232338, loss = 3.9882743 (40.433 sec)
[2018-03-26 03:39:34,066] step = 232338, loss = 3.9882743 (40.433 sec)
INFO:tensorflow:global_step/sec: 2.46738
[2018-03-26 03:40:14,593] global_step/sec: 2.46738
INFO:tensorflow:step = 232438, loss = 4.0492024 (40.529 sec)
[2018-03-26 03:40:14,595] step = 232438, loss = 4.0492024 (40.529 sec)
INFO:tensorflow:Saving checkpoints for 232537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:40:54,685] Saving checkpoints for 232537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.9441075.
[2018-03-26 03:40:59,181] Loss for final step: 3.9441075.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:40:59,182] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:40:59,191] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:40:59,194] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:40:59,264] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:40:59,341] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:41:03,052] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:41:03,052] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:41:03,052] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:41:03,052] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:41:03,052] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:41:03,053] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:41:03,053] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:41:03,095] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:41:04,512] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:41:04,521] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:41:10,747] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:41:10,836] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:41:10,854] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:41:10,864] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:41:15,473] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:41:15,791] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:41:15
[2018-03-26 03:41:15,828] Starting evaluation at 2018-03-26-00:41:15
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:41:16,293] Graph was finalized.
2018-03-26 03:41:16.293613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:41:16.293967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:41:16.294369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-232537
[2018-03-26 03:41:16,294] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-232537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:41:17,671] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:41:17,802] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:41:25,258] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:41:29,451] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:41:33,721] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:41:37,924] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:41:42,126] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:41:46,367] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:41:50,510] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:41:53,249] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:41:55,926] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:41:58,561] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:41:58
[2018-03-26 03:41:58,869] Finished evaluation at 2018-03-26-00:41:58
INFO:tensorflow:Saving dict for global step 232537: global_step = 232537, loss = 3.8521554, metrics-translate_en_to_ru/approx_bleu_score = 0.18060255, metrics-translate_en_to_ru/neg_log_perplexity = -4.3614054
[2018-03-26 03:41:58,872] Saving dict for global step 232537: global_step = 232537, loss = 3.8521554, metrics-translate_en_to_ru/approx_bleu_score = 0.18060255, metrics-translate_en_to_ru/neg_log_perplexity = -4.3614054
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:41:58,877] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:41:58,890] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:41:58,893] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:41:59,065] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:42:02,848] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:42:02,850] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:42:02,897] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:42:03,024] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:42:03,034] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:42:10,345] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:42:10,434] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:42:10,452] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:42:10,461] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:42:15,397] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:42:15,533] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:42:15,547] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:42:15,547] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:42:31,498] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:42:31,500] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:42:32,601] Graph was finalized.
2018-03-26 03:42:32.602272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:42:32.603272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:42:32.619355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-232537
[2018-03-26 03:42:32,620] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-232537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:42:36,140] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:42:36,389] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 232538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:43:06,289] Saving checkpoints for 232538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 232538, loss = 3.7883153
[2018-03-26 03:43:10,480] step = 232538, loss = 3.7883153
INFO:tensorflow:global_step/sec: 2.10372
[2018-03-26 03:43:58,014] global_step/sec: 2.10372
INFO:tensorflow:step = 232638, loss = 3.536508 (47.536 sec)
[2018-03-26 03:43:58,016] step = 232638, loss = 3.536508 (47.536 sec)
INFO:tensorflow:global_step/sec: 2.50217
[2018-03-26 03:44:37,979] global_step/sec: 2.50217
INFO:tensorflow:step = 232738, loss = 4.0454144 (39.965 sec)
[2018-03-26 03:44:37,981] step = 232738, loss = 4.0454144 (39.965 sec)
INFO:tensorflow:global_step/sec: 2.49781
[2018-03-26 03:45:18,014] global_step/sec: 2.49781
INFO:tensorflow:step = 232838, loss = 4.0848947 (40.035 sec)
[2018-03-26 03:45:18,016] step = 232838, loss = 4.0848947 (40.035 sec)
INFO:tensorflow:global_step/sec: 2.47764
[2018-03-26 03:45:58,375] global_step/sec: 2.47764
INFO:tensorflow:step = 232938, loss = 3.942195 (40.361 sec)
[2018-03-26 03:45:58,377] step = 232938, loss = 3.942195 (40.361 sec)
INFO:tensorflow:global_step/sec: 2.43865
[2018-03-26 03:46:39,381] global_step/sec: 2.43865
INFO:tensorflow:step = 233038, loss = 4.0503755 (41.007 sec)
[2018-03-26 03:46:39,384] step = 233038, loss = 4.0503755 (41.007 sec)
INFO:tensorflow:global_step/sec: 2.47051
[2018-03-26 03:47:19,859] global_step/sec: 2.47051
INFO:tensorflow:step = 233138, loss = 4.1010118 (40.476 sec)
[2018-03-26 03:47:19,860] step = 233138, loss = 4.1010118 (40.476 sec)
INFO:tensorflow:global_step/sec: 2.47353
[2018-03-26 03:48:00,287] global_step/sec: 2.47353
INFO:tensorflow:step = 233238, loss = 3.9384184 (40.431 sec)
[2018-03-26 03:48:00,291] step = 233238, loss = 3.9384184 (40.431 sec)
INFO:tensorflow:global_step/sec: 2.47113
[2018-03-26 03:48:40,754] global_step/sec: 2.47113
INFO:tensorflow:step = 233338, loss = 3.8412483 (40.466 sec)
[2018-03-26 03:48:40,756] step = 233338, loss = 3.8412483 (40.466 sec)
INFO:tensorflow:global_step/sec: 2.46494
[2018-03-26 03:49:21,323] global_step/sec: 2.46494
INFO:tensorflow:step = 233438, loss = 3.954329 (40.568 sec)
[2018-03-26 03:49:21,325] step = 233438, loss = 3.954329 (40.568 sec)
INFO:tensorflow:Saving checkpoints for 233537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:50:01,459] Saving checkpoints for 233537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.7104137.
[2018-03-26 03:50:05,953] Loss for final step: 3.7104137.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:50:05,954] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:50:05,965] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:50:05,968] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:50:06,052] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:50:06,129] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:50:09,728] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:50:09,728] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:50:09,728] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:50:09,728] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:50:09,728] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:50:09,728] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:50:09,729] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:50:09,772] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:50:09,888] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:50:09,898] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:50:16,975] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:50:17,055] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:50:17,071] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:50:17,079] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:50:21,205] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:50:21,483] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:50:21
[2018-03-26 03:50:21,504] Starting evaluation at 2018-03-26-00:50:21
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:50:21,897] Graph was finalized.
2018-03-26 03:50:21.897533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:50:21.897833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:50:21.898194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-233537
[2018-03-26 03:50:21,898] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-233537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:50:23,239] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:50:23,340] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:50:30,419] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:50:34,580] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:50:38,800] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:50:43,034] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:50:47,334] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 03:50:51,471] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 03:50:55,687] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 03:50:58,447] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 03:51:01,115] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 03:51:03,731] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-00:51:04
[2018-03-26 03:51:04,012] Finished evaluation at 2018-03-26-00:51:04
INFO:tensorflow:Saving dict for global step 233537: global_step = 233537, loss = 3.809006, metrics-translate_en_to_ru/approx_bleu_score = 0.18438755, metrics-translate_en_to_ru/neg_log_perplexity = -4.3108935
[2018-03-26 03:51:04,015] Saving dict for global step 233537: global_step = 233537, loss = 3.809006, metrics-translate_en_to_ru/approx_bleu_score = 0.18438755, metrics-translate_en_to_ru/neg_log_perplexity = -4.3108935
INFO:tensorflow:Training model for 1000 steps
[2018-03-26 03:51:04,019] Training model for 1000 steps
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
[2018-03-26 03:51:04,032] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-train*
INFO:tensorflow:partition: 0 num_data_files: 100
[2018-03-26 03:51:04,034] partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:51:04,202] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
[2018-03-26 03:51:07,859] Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:51:07,860] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:51:07,907] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:51:08,029] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:51:08,039] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:51:15,089] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:51:15,169] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:51:15,186] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:51:15,196] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:51:19,954] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Base learning rate: 0.200000
[2018-03-26 03:51:20,060] Base learning rate: 0.200000
INFO:tensorflow:Trainable Variables Total size: 44120064
[2018-03-26 03:51:20,073] Trainable Variables Total size: 44120064
INFO:tensorflow:Using optimizer Adam
[2018-03-26 03:51:20,073] Using optimizer Adam
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:51:35,798] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
[2018-03-26 03:51:35,799] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:51:36,900] Graph was finalized.
2018-03-26 03:51:36.900783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:51:36.901126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:51:36.917375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-233537
[2018-03-26 03:51:36,919] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-233537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:51:40,512] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:51:40,805] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 233538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:52:12,654] Saving checkpoints for 233538 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:step = 233538, loss = 3.7915256
[2018-03-26 03:52:16,861] step = 233538, loss = 3.7915256
INFO:tensorflow:global_step/sec: 2.05242
[2018-03-26 03:53:05,583] global_step/sec: 2.05242
INFO:tensorflow:step = 233638, loss = 3.882207 (48.724 sec)
[2018-03-26 03:53:05,585] step = 233638, loss = 3.882207 (48.724 sec)
INFO:tensorflow:global_step/sec: 2.4482
[2018-03-26 03:53:46,430] global_step/sec: 2.4482
INFO:tensorflow:step = 233738, loss = 3.5259845 (40.847 sec)
[2018-03-26 03:53:46,432] step = 233738, loss = 3.5259845 (40.847 sec)
INFO:tensorflow:global_step/sec: 2.46484
[2018-03-26 03:54:27,000] global_step/sec: 2.46484
INFO:tensorflow:step = 233838, loss = 3.5929554 (40.572 sec)
[2018-03-26 03:54:27,004] step = 233838, loss = 3.5929554 (40.572 sec)
INFO:tensorflow:global_step/sec: 2.46168
[2018-03-26 03:55:07,622] global_step/sec: 2.46168
INFO:tensorflow:step = 233938, loss = 3.4152834 (40.621 sec)
[2018-03-26 03:55:07,624] step = 233938, loss = 3.4152834 (40.621 sec)
INFO:tensorflow:global_step/sec: 2.44227
[2018-03-26 03:55:48,568] global_step/sec: 2.44227
INFO:tensorflow:step = 234038, loss = 3.7218745 (40.945 sec)
[2018-03-26 03:55:48,569] step = 234038, loss = 3.7218745 (40.945 sec)
INFO:tensorflow:global_step/sec: 2.45492
[2018-03-26 03:56:29,302] global_step/sec: 2.45492
INFO:tensorflow:step = 234138, loss = 4.0474343 (40.736 sec)
[2018-03-26 03:56:29,305] step = 234138, loss = 4.0474343 (40.736 sec)
INFO:tensorflow:global_step/sec: 2.45488
[2018-03-26 03:57:10,038] global_step/sec: 2.45488
INFO:tensorflow:step = 234238, loss = 3.711485 (40.735 sec)
[2018-03-26 03:57:10,041] step = 234238, loss = 3.711485 (40.735 sec)
INFO:tensorflow:global_step/sec: 2.46439
[2018-03-26 03:57:50,616] global_step/sec: 2.46439
INFO:tensorflow:step = 234338, loss = 3.5365553 (40.577 sec)
[2018-03-26 03:57:50,618] step = 234338, loss = 3.5365553 (40.577 sec)
INFO:tensorflow:global_step/sec: 2.4588
[2018-03-26 03:58:31,286] global_step/sec: 2.4588
INFO:tensorflow:step = 234438, loss = 4.0081162 (40.672 sec)
[2018-03-26 03:58:31,289] step = 234438, loss = 4.0081162 (40.672 sec)
INFO:tensorflow:Saving checkpoints for 234537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
[2018-03-26 03:59:11,891] Saving checkpoints for 234537 into /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt.
INFO:tensorflow:Loss for final step: 3.6429574.
[2018-03-26 03:59:16,658] Loss for final step: 3.6429574.
INFO:tensorflow:Evaluating model now.
[2018-03-26 03:59:16,659] Evaluating model now.
INFO:tensorflow:Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
[2018-03-26 03:59:16,668] Reading data files from /data/rimarakulin/en-ru-transfer_data/t2t_data/translate_en_to_ru-dev*
INFO:tensorflow:partition: 0 num_data_files: 1
[2018-03-26 03:59:16,670] partition: 0 num_data_files: 1
WARNING:tensorflow:Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
[2018-03-26 03:59:16,733] Padding the batch to ensure that remainder eval batches have a batch size divisible by the number of data shards. This may lead to incorrect metrics for non-zero-padded features, e.g. images. Use a single datashard (i.e. 1 GPU) in that case.
INFO:tensorflow:Calling model_fn.
[2018-03-26 03:59:16,804] Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'eval'
[2018-03-26 03:59:20,559] Setting T2TModel mode to 'eval'
INFO:tensorflow:Setting hparams.symbol_dropout to 0.0
[2018-03-26 03:59:20,560] Setting hparams.symbol_dropout to 0.0
INFO:tensorflow:Setting hparams.layer_prepostprocess_dropout to 0.0
[2018-03-26 03:59:20,560] Setting hparams.layer_prepostprocess_dropout to 0.0
INFO:tensorflow:Setting hparams.attention_dropout to 0.0
[2018-03-26 03:59:20,560] Setting hparams.attention_dropout to 0.0
INFO:tensorflow:Setting hparams.relu_dropout to 0.0
[2018-03-26 03:59:20,560] Setting hparams.relu_dropout to 0.0
INFO:tensorflow:Setting hparams.dropout to 0.0
[2018-03-26 03:59:20,560] Setting hparams.dropout to 0.0
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
[2018-03-26 03:59:20,561] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:59:20,609] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:59:20,745] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:59:20,762] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:59:28,225] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_33708_512.bottom
[2018-03-26 03:59:28,297] Transforming feature 'inputs' with symbol_modality_33708_512.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_33708_512.targets_bottom
[2018-03-26 03:59:28,312] Transforming 'targets' with symbol_modality_33708_512.targets_bottom
INFO:tensorflow:Building model body
[2018-03-26 03:59:28,320] Building model body
INFO:tensorflow:Transforming body output with symbol_modality_33708_512.top
[2018-03-26 03:59:31,851] Transforming body output with symbol_modality_33708_512.top
INFO:tensorflow:Done calling model_fn.
[2018-03-26 03:59:32,396] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2018-03-26-00:59:32
[2018-03-26 03:59:32,414] Starting evaluation at 2018-03-26-00:59:32
INFO:tensorflow:Graph was finalized.
[2018-03-26 03:59:32,772] Graph was finalized.
2018-03-26 03:59:32.772664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0, 1
2018-03-26 03:59:32.773048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7708 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0, compute capability: 6.1)
2018-03-26 03:59:32.786570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 7708 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080, pci bus id: 0000:05:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-234537
[2018-03-26 03:59:32,788] Restoring parameters from /data/rimarakulin/en-ru-transfer_data/t2t_train/translate_en_to_ru/model.ckpt-234537
INFO:tensorflow:Running local_init_op.
[2018-03-26 03:59:34,403] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
[2018-03-26 03:59:34,565] Done running local_init_op.
INFO:tensorflow:Evaluation [10/100]
[2018-03-26 03:59:42,353] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
[2018-03-26 03:59:46,540] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
[2018-03-26 03:59:50,699] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
[2018-03-26 03:59:55,015] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
[2018-03-26 03:59:59,349] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
[2018-03-26 04:00:03,669] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
[2018-03-26 04:00:07,925] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
[2018-03-26 04:00:10,694] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
[2018-03-26 04:00:13,406] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
[2018-03-26 04:00:16,099] Evaluation [100/100]
INFO:tensorflow:Finished evaluation at 2018-03-26-01:00:16
[2018-03-26 04:00:16,432] Finished evaluation at 2018-03-26-01:00:16
INFO:tensorflow:Saving dict for global step 234537: global_step = 234537, loss = 3.781116, metrics-translate_en_to_ru/approx_bleu_score = 0.18734886, metrics-translate_en_to_ru/neg_log_perplexity = -4.270958
[2018-03-26 04:00:16,435] Saving dict for global step 234537: global_step = 234537, loss = 3.781116, metrics-translate_en_to_ru/approx_bleu_score = 0.18734886, metrics-translate_en_to_ru/neg_log_perplexity = -4.270958
INFO:tensorflow:Stop training model as max steps reached
[2018-03-26 04:00:16,438] Stop training model as max steps reached
